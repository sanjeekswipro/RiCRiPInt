<!-- Copyright (C) 2007 Global Graphics Software Ltd. All rights reserved. -->
<!-- Global Graphics Software Ltd. Confidential Information. -->
<!-- $HopeName: SWprod_hqnrip!clrip:branding:lekit-header.html(EBDSDK_P.1) $ -->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"> <html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1"> <title>Harlequin RIP SDK: fndcrypt.c File Reference</title> <h5 style="align: right;"><a href="http://www.globalgraphics.com" target="_blank"><img src="./gg_logo.gif" alt="Global Graphics logo" align="middle" border=0></a><img src="./spacer.gif">Harlequin RIP SDK Documentation</h5> <link href="doxygen.css" rel="stylesheet" type="text/css"> </head> </html> 
<!-- Generated by Doxygen 1.6.2 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_19043388fc15ddb67e28f7a33621a223.html">skinkit</a>&nbsp;&raquo;&nbsp;<a class="el" href="dir_1a92abee00141eb4bc1b55dcfd46ed15.html">src</a>
  </div>
</div>
<div class="contents">
<h1>fndcrypt.c File Reference</h1>
<p>Example implementation of the font decoder and encoder filter. If you wish to just test font decoding, define TEST_DECRYPTFONT instead. There are two encryption algorithms supported, to show how to implement multiple strategies.  
<a href="#_details">More...</a></p>
<code>#include &quot;<a class="el" href="ripthread_8h.html">ripthread.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="swdevice_8h.html">swdevice.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="skindevs_8h.html">skindevs.h</a>&quot;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct__fND__state.html">_fND_state</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Encapsulates the current state of the font encoder/decoder device.  <a href="struct__fND__state.html#_details">More...</a><br/></td></tr>
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a745fe865f800422b85adc2ff3f218364"></a><!-- doxytag: member="fndcrypt.c::ADLER32_BASE" ref="a745fe865f800422b85adc2ff3f218364" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fndcrypt_8c.html#a745fe865f800422b85adc2ff3f218364">ADLER32_BASE</a>&nbsp;&nbsp;&nbsp;65521</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Modulus for the Adler 32 algorithm. <br/></td></tr>
<tr><td colspan="2"><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa2e45f202b1d930de3f7f3d62b577c19"></a><!-- doxytag: member="fndcrypt.c::FND_STATE" ref="aa2e45f202b1d930de3f7f3d62b577c19" args="" -->
typedef struct <a class="el" href="struct__fND__state.html">_fND_state</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fndcrypt_8c.html#aa2e45f202b1d930de3f7f3d62b577c19">FND_STATE</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Encapsulates the current state of the font encoder/decoder device. <br/></td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa1f3f0d107c0234919c2837514d692b1"></a><!-- doxytag: member="fndcrypt.c::fND_init_device" ref="aa1f3f0d107c0234919c2837514d692b1" args="(DEVICELIST *dev)" -->
static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fndcrypt_8c.html#aa1f3f0d107c0234919c2837514d692b1">fND_init_device</a> (<a class="el" href="structdevicelist.html">DEVICELIST</a> *dev)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">fND_init_device <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static DEVICE_FILEDESCRIPTOR&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fndcrypt_8c.html#a0f5a95ca0b6e5e288a99a27a6bcd9ab6">fND_open_file</a> (<a class="el" href="structdevicelist.html">DEVICELIST</a> *dev, <a class="el" href="group__stdtypes.html#ga3c77e3a247345b581bdb6939ffe95a94">uint8</a> *filename, <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> openflags)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">fND_open_file  <a href="#a0f5a95ca0b6e5e288a99a27a6bcd9ab6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fndcrypt_8c.html#aa84308da54f5922924dbb5bed3c0a3dc">fND_read_file</a> (<a class="el" href="structdevicelist.html">DEVICELIST</a> *dev, DEVICE_FILEDESCRIPTOR descriptor, <a class="el" href="group__stdtypes.html#ga3c77e3a247345b581bdb6939ffe95a94">uint8</a> *buff, <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> len)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">fND_read_file  <a href="#aa84308da54f5922924dbb5bed3c0a3dc"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a44eb246ec39c8453d0fbb9bb005a8ce0"></a><!-- doxytag: member="fndcrypt.c::fND_write_file" ref="a44eb246ec39c8453d0fbb9bb005a8ce0" args="(DEVICELIST *dev, DEVICE_FILEDESCRIPTOR descriptor, uint8 *buff, int32 len)" -->
static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fndcrypt_8c.html#a44eb246ec39c8453d0fbb9bb005a8ce0">fND_write_file</a> (<a class="el" href="structdevicelist.html">DEVICELIST</a> *dev, DEVICE_FILEDESCRIPTOR descriptor, <a class="el" href="group__stdtypes.html#ga3c77e3a247345b581bdb6939ffe95a94">uint8</a> *buff, <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> len)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">fND_write_file <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac36a3d81045f3ae98a225951e8c17e3b"></a><!-- doxytag: member="fndcrypt.c::fND_close_file" ref="ac36a3d81045f3ae98a225951e8c17e3b" args="(DEVICELIST *dev, DEVICE_FILEDESCRIPTOR descriptor)" -->
static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fndcrypt_8c.html#ac36a3d81045f3ae98a225951e8c17e3b">fND_close_file</a> (<a class="el" href="structdevicelist.html">DEVICELIST</a> *dev, DEVICE_FILEDESCRIPTOR descriptor)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">fND_close_file <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7ae3f536ed8144748777833f964ff57c"></a><!-- doxytag: member="fndcrypt.c::fND_seek_file" ref="a7ae3f536ed8144748777833f964ff57c" args="(DEVICELIST *dev, DEVICE_FILEDESCRIPTOR descriptor, Hq32x2 *destn, int32 flags)" -->
static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fndcrypt_8c.html#a7ae3f536ed8144748777833f964ff57c">fND_seek_file</a> (<a class="el" href="structdevicelist.html">DEVICELIST</a> *dev, DEVICE_FILEDESCRIPTOR descriptor, <a class="el" href="structHq32x2.html">Hq32x2</a> *destn, <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> flags)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">fND_seek_file <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad43986327d1fc2653f6b47a8f1772def"></a><!-- doxytag: member="fndcrypt.c::fND_bytes_file" ref="ad43986327d1fc2653f6b47a8f1772def" args="(DEVICELIST *dev, DEVICE_FILEDESCRIPTOR descriptor, Hq32x2 *bytes, int32 reason)" -->
static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fndcrypt_8c.html#ad43986327d1fc2653f6b47a8f1772def">fND_bytes_file</a> (<a class="el" href="structdevicelist.html">DEVICELIST</a> *dev, DEVICE_FILEDESCRIPTOR descriptor, <a class="el" href="structHq32x2.html">Hq32x2</a> *bytes, <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> reason)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">fND_bytes_file <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a695275e3af01997fe406504a63ec8bc0"></a><!-- doxytag: member="fndcrypt.c::fND_status_file" ref="a695275e3af01997fe406504a63ec8bc0" args="(DEVICELIST *dev, uint8 *filename, STAT *statbuff)" -->
static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fndcrypt_8c.html#a695275e3af01997fe406504a63ec8bc0">fND_status_file</a> (<a class="el" href="structdevicelist.html">DEVICELIST</a> *dev, <a class="el" href="group__stdtypes.html#ga3c77e3a247345b581bdb6939ffe95a94">uint8</a> *filename, <a class="el" href="structSTAT.html">STAT</a> *statbuff)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">fND_status_file <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a164d9a20530177b2e5c27727cc0f5e37"></a><!-- doxytag: member="fndcrypt.c::fND_interp_start_file_list" ref="a164d9a20530177b2e5c27727cc0f5e37" args="(DEVICELIST *dev, uint8 *pattern)" -->
static void *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fndcrypt_8c.html#a164d9a20530177b2e5c27727cc0f5e37">fND_interp_start_file_list</a> (<a class="el" href="structdevicelist.html">DEVICELIST</a> *dev, <a class="el" href="group__stdtypes.html#ga3c77e3a247345b581bdb6939ffe95a94">uint8</a> *pattern)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">*fND_interp_start_file_list <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6ab1b32e22a60dcc8fea51640a72e341"></a><!-- doxytag: member="fndcrypt.c::fND_interp_next_file" ref="a6ab1b32e22a60dcc8fea51640a72e341" args="(DEVICELIST *dev, void **handle, uint8 *pattern, FILEENTRY *entry)" -->
static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fndcrypt_8c.html#a6ab1b32e22a60dcc8fea51640a72e341">fND_interp_next_file</a> (<a class="el" href="structdevicelist.html">DEVICELIST</a> *dev, void **handle, <a class="el" href="group__stdtypes.html#ga3c77e3a247345b581bdb6939ffe95a94">uint8</a> *pattern, <a class="el" href="structFILEENTRY.html">FILEENTRY</a> *entry)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">fND_interp_next_file <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a956780258c751b96ae1333dd0e1028b1"></a><!-- doxytag: member="fndcrypt.c::fND_interp_end_file_list" ref="a956780258c751b96ae1333dd0e1028b1" args="(DEVICELIST *dev, void *handle)" -->
static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fndcrypt_8c.html#a956780258c751b96ae1333dd0e1028b1">fND_interp_end_file_list</a> (<a class="el" href="structdevicelist.html">DEVICELIST</a> *dev, void *handle)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">fND_interp_end_file_list <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a73e8ba2b89b8c84d5f0a646b202bb0db"></a><!-- doxytag: member="fndcrypt.c::fND_rename_file" ref="a73e8ba2b89b8c84d5f0a646b202bb0db" args="(DEVICELIST *dev, uint8 *file1, uint8 *file2)" -->
static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fndcrypt_8c.html#a73e8ba2b89b8c84d5f0a646b202bb0db">fND_rename_file</a> (<a class="el" href="structdevicelist.html">DEVICELIST</a> *dev, <a class="el" href="group__stdtypes.html#ga3c77e3a247345b581bdb6939ffe95a94">uint8</a> *file1, <a class="el" href="group__stdtypes.html#ga3c77e3a247345b581bdb6939ffe95a94">uint8</a> *file2)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">fND_rename_file <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac9d92a9822e96cff7f3e85a635234f16"></a><!-- doxytag: member="fndcrypt.c::fND_delete_file" ref="ac9d92a9822e96cff7f3e85a635234f16" args="(DEVICELIST *dev, uint8 *filename)" -->
static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fndcrypt_8c.html#ac9d92a9822e96cff7f3e85a635234f16">fND_delete_file</a> (<a class="el" href="structdevicelist.html">DEVICELIST</a> *dev, <a class="el" href="group__stdtypes.html#ga3c77e3a247345b581bdb6939ffe95a94">uint8</a> *filename)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">fND_delete_file <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ace4f44240f85c06195fb53aec2c8a027"></a><!-- doxytag: member="fndcrypt.c::fND_set_param" ref="ace4f44240f85c06195fb53aec2c8a027" args="(DEVICELIST *dev, DEVICEPARAM *param)" -->
static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fndcrypt_8c.html#ace4f44240f85c06195fb53aec2c8a027">fND_set_param</a> (<a class="el" href="structdevicelist.html">DEVICELIST</a> *dev, <a class="el" href="structDEVICEPARAM.html">DEVICEPARAM</a> *param)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">fND_set_param <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="acb4a49cb2c8ec80ba454dbc04646a851"></a><!-- doxytag: member="fndcrypt.c::fND_start_param" ref="acb4a49cb2c8ec80ba454dbc04646a851" args="(DEVICELIST *dev)" -->
static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fndcrypt_8c.html#acb4a49cb2c8ec80ba454dbc04646a851">fND_start_param</a> (<a class="el" href="structdevicelist.html">DEVICELIST</a> *dev)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">fND_start_param <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a318a3b2ba94f45b35b65fdecede0ce91"></a><!-- doxytag: member="fndcrypt.c::fND_get_param" ref="a318a3b2ba94f45b35b65fdecede0ce91" args="(DEVICELIST *dev, DEVICEPARAM *param)" -->
static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fndcrypt_8c.html#a318a3b2ba94f45b35b65fdecede0ce91">fND_get_param</a> (<a class="el" href="structdevicelist.html">DEVICELIST</a> *dev, <a class="el" href="structDEVICEPARAM.html">DEVICEPARAM</a> *param)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">fND_get_param This accepts an explicit request for a param, but not a forall <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a479f67e6a898af8f82c8d68ed9733b47"></a><!-- doxytag: member="fndcrypt.c::fND_status_device" ref="a479f67e6a898af8f82c8d68ed9733b47" args="(DEVICELIST *dev, DEVSTAT *devstat)" -->
static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fndcrypt_8c.html#a479f67e6a898af8f82c8d68ed9733b47">fND_status_device</a> (<a class="el" href="structdevicelist.html">DEVICELIST</a> *dev, DEVSTAT *devstat)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">fND_status_device <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac46f91723e54eeac9b5424da251da6ef"></a><!-- doxytag: member="fndcrypt.c::fND_dismount_device" ref="ac46f91723e54eeac9b5424da251da6ef" args="(DEVICELIST *dev)" -->
static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fndcrypt_8c.html#ac46f91723e54eeac9b5424da251da6ef">fND_dismount_device</a> (<a class="el" href="structdevicelist.html">DEVICELIST</a> *dev)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">fND_dismount_device <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9123c28925cdd1b63c125771665008a9"></a><!-- doxytag: member="fndcrypt.c::fND_buffersize" ref="a9123c28925cdd1b63c125771665008a9" args="(DEVICELIST *dev)" -->
static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fndcrypt_8c.html#a9123c28925cdd1b63c125771665008a9">fND_buffersize</a> (<a class="el" href="structdevicelist.html">DEVICELIST</a> *dev)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">fND_buffersize <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a40dd2ac66156c8e5af5558bdde7bb948"></a><!-- doxytag: member="fndcrypt.c::fND_void" ref="a40dd2ac66156c8e5af5558bdde7bb948" args="(void)" -->
static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fndcrypt_8c.html#a40dd2ac66156c8e5af5558bdde7bb948">fND_void</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">fND_void <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac0716d64bc33807fd29eebeba020ef61"></a><!-- doxytag: member="fndcrypt.c::calculateAdler32" ref="ac0716d64bc33807fd29eebeba020ef61" args="(uint8 *byteptr, int32 count, uint16 *s1, uint16 *s2)" -->
static <a class="el" href="group__stdtypes.html#ga8ad23e2333787a214e20a58a284a5a60">uint32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fndcrypt_8c.html#ac0716d64bc33807fd29eebeba020ef61">calculateAdler32</a> (<a class="el" href="group__stdtypes.html#ga3c77e3a247345b581bdb6939ffe95a94">uint8</a> *byteptr, <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> count, <a class="el" href="group__stdtypes.html#gaab595e79c3681bc54045211cb5c8d8bb">uint16</a> *s1, <a class="el" href="group__stdtypes.html#gaab595e79c3681bc54045211cb5c8d8bb">uint16</a> *s2)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Calculate an Adler32 checksum, similar to the Flate standard. This is used in the path "encryption" to supply a checksum based upon the path string. See the comments above about security of the encryption filter. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac37d3a386ad2491fea541147975ff7f8"></a><!-- doxytag: member="fndcrypt.c::FDread" ref="ac37d3a386ad2491fea541147975ff7f8" args="(FND_STATE *pState)" -->
static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fndcrypt_8c.html#ac37d3a386ad2491fea541147975ff7f8">FDread</a> (<a class="el" href="struct__fND__state.html">FND_STATE</a> *pState)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Called from FDGetc when needs more data. <br/></td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae22cacb7827f332333080bdb1dbaed05"></a><!-- doxytag: member="fndcrypt.c::FontNDcrypt_Device_Type" ref="ae22cacb7827f332333080bdb1dbaed05" args="" -->
<a class="el" href="structDeviceType.html">DEVICETYPE</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="fndcrypt_8c.html#ae22cacb7827f332333080bdb1dbaed05">FontNDcrypt_Device_Type</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Encapsulates the set of entry points for the font encoder/decoder device. <br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Example implementation of the font decoder and encoder filter. If you wish to just test font decoding, define TEST_DECRYPTFONT instead. There are two encryption algorithms supported, to show how to implement multiple strategies. </p>
<p>Implementing the encryption filter as the straight inverse of the decryption filter is not secure; it is very vulnerable to chosen plaintext attacks. The path provided by HDLT is a binary encoded userpath; the protection attribute is a combination of all of the protection methods used in constructing the path. If an unprotected path is created, and a charpath from a protected font is added to the path, the whole path will be exported using the protected font's methods. The initial parts of the binary encoded path will be known to the attacker (they are the unprotected part of the path), and this can be exploited to break the encryption method.</p>
<p>Do NOT implement a pass-through write_file routine here under any circumstances, it'll make your font data insecure. It must either encrypt the data it sees securely or return an error. Checking the openflags on your open call and faulting any call which is not SW_RDONLY would be best.</p>
<p>The encryption here is a better example of how to keep your encryption algorithm secure. It demonstrates one half of a method that works in a closed environment. The path supplied to the encryption filter should be stored by the filter, which return the results of a secure hash function applied to the path. The client code can pass the hash value to consumers, who then communicate with the font encryption filter to retrieve the path.</p>
<p>Note that encoded userpaths consist of two parts, the arguments and the commands, so in such a case storing two strings under one hash value would be useful.</p>
<p>The example "encryption" in this file actually adds a header revealing the strategy used, and then outputs a checksum of the string.</p>
<p>The following code is the decryption algorithm in that we're testing for:</p>
<p>void encrypt_string_algorithm1( slist, slen ) { int32 xorchar = 0x00;</p>
<p>while ((--slen) &gt;= 0 ) { slist[ 0 ] ^= xorchar; xorchar += slist[ 0 ]; slist++; } }</p>
<p>void encrypt_string_algorithm2( slist, slen ) { int32 xorchar = 0x00;</p>
<p>while ((--slen) &gt;= 0 ) { slist[ 0 ] ^= xorchar; xorchar += slist[ 0 ]; xorchar += 0x10; slist++; } }</p>
<p>These encryptions cannot be pre-verified, so the code here will not return DeviceIOError to say "this isn't in my code," most most other features of the filter will be exercised. </p>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a0f5a95ca0b6e5e288a99a27a6bcd9ab6"></a><!-- doxytag: member="fndcrypt.c::fND_open_file" ref="a0f5a95ca0b6e5e288a99a27a6bcd9ab6" args="(DEVICELIST *dev, uint8 *filename, int32 openflags)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static DEVICE_FILEDESCRIPTOR fND_open_file </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdevicelist.html">DEVICELIST</a> *&nbsp;</td>
          <td class="paramname"> <em>dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__stdtypes.html#ga3c77e3a247345b581bdb6939ffe95a94">uint8</a> *&nbsp;</td>
          <td class="paramname"> <em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a>&nbsp;</td>
          <td class="paramname"> <em>openflags</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>fND_open_file </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>dev</em>&nbsp;</td><td>the device handle </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>filename</em>&nbsp;</td><td>will be null </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>openflags</em>&nbsp;</td><td>is appropriate flag, read/write </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="aa84308da54f5922924dbb5bed3c0a3dc"></a><!-- doxytag: member="fndcrypt.c::fND_read_file" ref="aa84308da54f5922924dbb5bed3c0a3dc" args="(DEVICELIST *dev, DEVICE_FILEDESCRIPTOR descriptor, uint8 *buff, int32 len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> fND_read_file </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structdevicelist.html">DEVICELIST</a> *&nbsp;</td>
          <td class="paramname"> <em>dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">DEVICE_FILEDESCRIPTOR&nbsp;</td>
          <td class="paramname"> <em>descriptor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__stdtypes.html#ga3c77e3a247345b581bdb6939ffe95a94">uint8</a> *&nbsp;</td>
          <td class="paramname"> <em>buff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a>&nbsp;</td>
          <td class="paramname"> <em>len</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>fND_read_file </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>dev</em>&nbsp;</td><td>the device handle </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>descriptor</em>&nbsp;</td><td>is filter's unique value returned by openfile, </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>buff</em>&nbsp;</td><td>is the buffer to fill, </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>len</em>&nbsp;</td><td>is space available </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div>
<hr size="1"><address style="align: right;">
<!-- $HopeName: SWprod_hqnrip!clrip:branding:footer.html(EBDSDK_P.1) $ -->
<!-- Copyright (C) 2007 Global Graphics Software Ltd. All rights reserved. -->
<!-- Global Graphics Software Ltd. Confidential Information. -->

<i><small>For information on other products from Global Graphics, visit <a href="http://www.globalgraphics.com" target="_blank">www.globalgraphics.com</a></small></i></address>
</body>
</html>
