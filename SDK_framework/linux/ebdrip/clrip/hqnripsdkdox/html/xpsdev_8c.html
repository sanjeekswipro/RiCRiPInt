<!-- Copyright (C) 2007 Global Graphics Software Ltd. All rights reserved. -->
<!-- Global Graphics Software Ltd. Confidential Information. -->
<!-- $HopeName: SWprod_hqnrip!clrip:branding:lekit-header.html(EBDSDK_P.1) $ -->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"> <html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1"> <title>Harlequin RIP SDK: xpsdev.c File Reference</title> <h5 style="align: right;"><a href="http://www.globalgraphics.com" target="_blank"><img src="./gg_logo.gif" alt="Global Graphics logo" align="middle" border=0></a><img src="./spacer.gif">Harlequin RIP SDK Documentation</h5> <link href="doxygen.css" rel="stylesheet" type="text/css"> </head> </html> 
<!-- Generated by Doxygen 1.6.2 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_19043388fc15ddb67e28f7a33621a223.html">skinkit</a>&nbsp;&raquo;&nbsp;<a class="el" href="dir_1a92abee00141eb4bc1b55dcfd46ed15.html">src</a>
  </div>
</div>
<div class="contents">
<h1>xpsdev.c File Reference</h1>
<p>Implementation of an input device for obtaining XPS page parts from an external source.  
<a href="#_details">More...</a></p>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="mem_8h.html">mem.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="memfs_8h.html">memfs.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="swdevice_8h.html">swdevice.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="skindevs_8h.html">skindevs.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="hqstr_8h.html">hqstr.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="ripthread_8h.html">ripthread.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="file_8h.html">file.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="sync_8h.html">sync.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="streams_8h.html">streams.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="xpsbuild_8h.html">xpsbuild.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="xpsdev_8h.html">xpsdev.h</a>&quot;</code><br/>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct__XPSDeviceState.html">_XPSDeviceState</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Encapsulates the state of a single instance of the XPS device.  <a href="struct__XPSDeviceState.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct__XPSFILEDESC.html">_XPSFILEDESC</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Encapsulates a file descriptor for this device.  <a href="struct__XPSFILEDESC.html#_details">More...</a><br/></td></tr>
<tr><td colspan="2"><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a440338cd3c1500262942cc2ebe0057c0"></a><!-- doxytag: member="xpsdev.c::XPSDeviceState" ref="a440338cd3c1500262942cc2ebe0057c0" args="" -->
typedef struct <a class="el" href="struct__XPSDeviceState.html">_XPSDeviceState</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xpsdev_8c.html#a440338cd3c1500262942cc2ebe0057c0">XPSDeviceState</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Encapsulates the state of a single instance of the XPS device. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct__XPSFILEDESC.html">_XPSFILEDESC</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xpsdev_8c.html#abf6d68c206b1920727300bdd32d0866a">XPSFILEDESC</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Encapsulates a file descriptor for this device.  <a href="#abf6d68c206b1920727300bdd32d0866a"></a><br/></td></tr>
<tr><td colspan="2"><h2>Enumerations</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Enumeration to indicate the two types of file that can be open on this device: either an in-memory file, or a client-managed HqnReadStream. </p>
<br/></td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xpsdev_8c.html#aa6b2c04f6d55ccade7212aea31cede15">xpsdevSetPackage</a> (<a class="el" href="struct__XPSPackageDescription.html">XPSPackageDescription</a> *pPD, <a class="el" href="struct__XPSPackageStreamManager.html">XPSPackageStreamManager</a> *pPSM, <a class="el" href="group__stdtypes.html#ga8ad23e2333787a214e20a58a284a5a60">uint32</a> fComplete)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Establish the package description and stream manager that should be adopted in the device state when the <em>next</em> instance of xpsdev is mounted.  <a href="#aa6b2c04f6d55ccade7212aea31cede15"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xpsdev_8c.html#a70ced5788425a5573183fcc36e517259">xpsdevClearPackage</a> (void)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Disassociate the xpsdev device type from any notion of the "current" package.  <a href="#a70ced5788425a5573183fcc36e517259"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xpsdev_8c.html#ace6981257d0106f55e73c3670a48f01c">xpsdevAddFixedDocument</a> (<a class="el" href="group__stdtypes.html#ga3c77e3a247345b581bdb6939ffe95a94">uint8</a> *pszDevice, <a class="el" href="struct__XPSDocumentDescription.html">XPSDocumentDescription</a> *pDocument)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add a new XPS Fixed Document to an unfinished package.  <a href="#ace6981257d0106f55e73c3670a48f01c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xpsdev_8c.html#a9f03a386114f62ad7d8ee035d5bc2c88">xpsdevAddFixedPage</a> (<a class="el" href="group__stdtypes.html#ga3c77e3a247345b581bdb6939ffe95a94">uint8</a> *pszDevice, <a class="el" href="struct__XPSPageDescription.html">XPSPageDescription</a> *pPage)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add a new XPS Fixed Page to an unfinished package.  <a href="#a9f03a386114f62ad7d8ee035d5bc2c88"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xpsdev_8c.html#ae3090ca279433c9a491efc15eb12e249">xpsdevSetPackageComplete</a> (<a class="el" href="group__stdtypes.html#ga3c77e3a247345b581bdb6939ffe95a94">uint8</a> *pszDevice)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Signal that an unfinished package is now complete, and that no further pages or documents will be added.  <a href="#ae3090ca279433c9a491efc15eb12e249"></a><br/></td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad843828c3202d415e0c7229f8efbcceb"></a><!-- doxytag: member="xpsdev.c::szParamType" ref="ad843828c3202d415e0c7229f8efbcceb" args="" -->
static <a class="el" href="group__stdtypes.html#ga3c77e3a247345b581bdb6939ffe95a94">uint8</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xpsdev_8c.html#ad843828c3202d415e0c7229f8efbcceb">szParamType</a> = (<a class="el" href="group__stdtypes.html#ga3c77e3a247345b581bdb6939ffe95a94">uint8</a>*) &quot;Type&quot;</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Name of the single, read-only device parameter for this device. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7e0a161310f4cff4f0a91959ef541d88"></a><!-- doxytag: member="xpsdev.c::szParamValueFileSystem" ref="a7e0a161310f4cff4f0a91959ef541d88" args="" -->
static <a class="el" href="group__stdtypes.html#ga3c77e3a247345b581bdb6939ffe95a94">uint8</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xpsdev_8c.html#a7e0a161310f4cff4f0a91959ef541d88">szParamValueFileSystem</a> = (<a class="el" href="group__stdtypes.html#ga3c77e3a247345b581bdb6939ffe95a94">uint8</a>*) &quot;FileSystem&quot;</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Constant value of the <code>/Type</code> device parameter. This allows the RIP to classify this device as a storage medium. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a90566a73151f5af3d74a7eb862196ca9"></a><!-- doxytag: member="xpsdev.c::XpsInput_Device_Type" ref="a90566a73151f5af3d74a7eb862196ca9" args="" -->
<a class="el" href="structDeviceType.html">DEVICETYPE</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xpsdev_8c.html#a90566a73151f5af3d74a7eb862196ca9">XpsInput_Device_Type</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The XPS input device type structure. <br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Implementation of an input device for obtaining XPS page parts from an external source. </p>
<hr/><h2>Typedef Documentation</h2>
<a class="anchor" id="abf6d68c206b1920727300bdd32d0866a"></a><!-- doxytag: member="xpsdev.c::XPSFILEDESC" ref="abf6d68c206b1920727300bdd32d0866a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct__XPSFILEDESC.html">_XPSFILEDESC</a>  <a class="el" href="struct__XPSFILEDESC.html">XPSFILEDESC</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Encapsulates a file descriptor for this device. </p>
<p>A "file" on the XPS device might be one of two things. It might be a pointer to an in-memory file managed by the skin's Memory File System (MFS). In this case, the underlying file descriptor is actually an MFSFILEDESC structure. Alternatively, the "file" might be a pointer to an HqnReadStream, which was supplied by calling <a class="el" href="streams_8h.html#ad723adb3ef2667a23cc5145fa7a6024d" title="Function called by the RIP to open a stream on a specified resource within the context...">OpenResourceStreamFn()</a> on the XPSPackageStreamManager associated with this device.</p>
<p>This structure just wraps a union of those two pointer types, with an integer discriminator. </p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ace6981257d0106f55e73c3670a48f01c"></a><!-- doxytag: member="xpsdev.c::xpsdevAddFixedDocument" ref="ace6981257d0106f55e73c3670a48f01c" args="(uint8 *pszDevice, XPSDocumentDescription *pDocument)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> xpsdevAddFixedDocument </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__stdtypes.html#ga3c77e3a247345b581bdb6939ffe95a94">uint8</a> *&nbsp;</td>
          <td class="paramname"> <em>pszDevice</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct__XPSDocumentDescription.html">XPSDocumentDescription</a> *&nbsp;</td>
          <td class="paramname"> <em>pDocument</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Add a new XPS Fixed Document to an unfinished package. </p>
<p>This function cannot be called until a named instance of xpsdev has been mounted from PostScript.</p>
<p>This function can be used to extend the contents of a package while it is being interpreted. It is intended for use in "streaming consumption" scenarios, where the complete content of the package is not known in advance. It can only be called when the original package was specified as <em>incomplete</em>, which means that <code>FALSE</code> must have been passed as the final argument to <code><a class="el" href="xpsdev_8c.html#aa6b2c04f6d55ccade7212aea31cede15" title="Establish the package description and stream manager that should be adopted in the...">xpsdevSetPackage()</a></code>.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pszDevice</em>&nbsp;</td><td>Nul-terminated name of the xpsdev instance that was mounted from PostScript. This name should <em>not</em> include any delimiting percent characters. A device of this name must have been mounted, otherwise the function will fail.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pDocument</em>&nbsp;</td><td>Pointer to a description of the document and its pages. It is permitted for the document to be empty (meaning that its <code>pPageDescriptions</code> field is <code>NULL</code>, and its <code>nPages</code> field is zero). This would be typical when adding a document before adding any of its pages. If the document is empty, at least one page must be added to it by a subsequent call to <code><a class="el" href="xpsdev_8c.html#a9f03a386114f62ad7d8ee035d5bc2c88" title="Add a new XPS Fixed Page to an unfinished package.">xpsdevAddFixedPage()</a></code>, otherwise the package will not conform to the XPS specification. (It is not legal for a Fixed Document to have zero Fixed Pages). If the document is non-empty, this function will add all of its pages automatically, but it remains possible to add further pages with explicit calls to <code><a class="el" href="xpsdev_8c.html#a9f03a386114f62ad7d8ee035d5bc2c88" title="Add a new XPS Fixed Page to an unfinished package.">xpsdevAddFixedPage()</a></code>. Note that if the <code>nPages</code> field of the document description is greater than zero, the <code>pPageDescriptions</code> field <em>must not</em> be <code>NULL</code>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>TRUE upon success; FALSE upon failure. If the function fails, the named device will have its last error code set appropriately, as long as the device is mounted. </dd></dl>

</div>
</div>
<a class="anchor" id="a9f03a386114f62ad7d8ee035d5bc2c88"></a><!-- doxytag: member="xpsdev.c::xpsdevAddFixedPage" ref="a9f03a386114f62ad7d8ee035d5bc2c88" args="(uint8 *pszDevice, XPSPageDescription *pPage)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> xpsdevAddFixedPage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__stdtypes.html#ga3c77e3a247345b581bdb6939ffe95a94">uint8</a> *&nbsp;</td>
          <td class="paramname"> <em>pszDevice</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct__XPSPageDescription.html">XPSPageDescription</a> *&nbsp;</td>
          <td class="paramname"> <em>pPage</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Add a new XPS Fixed Page to an unfinished package. </p>
<p>This function cannot be called until a named instance of xpsdev has been mounted from PostScript.</p>
<p>This function can be used to extend the contents of a package while it is being interpreted. It is intended for use in "streaming consumption" scenarios, where the complete content of the package is not known in advance. It can only be called when the original package was specified as <em>incomplete</em>, which means that <code>FALSE</code> must have been passed as the final argument to <code><a class="el" href="xpsdev_8c.html#aa6b2c04f6d55ccade7212aea31cede15" title="Establish the package description and stream manager that should be adopted in the...">xpsdevSetPackage()</a></code>.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pszDevice</em>&nbsp;</td><td>Nul-terminated name of the xpsdev instance that was mounted from PostScript. This name should <em>not</em> include any delimiting percent characters. A device of this name must have been mounted, otherwise the function will fail.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pPage</em>&nbsp;</td><td>Pointer to a description of the page and its resources. All resources used by the page must be described. There is no interface for adding additional resource usage later.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>TRUE upon success; FALSE upon failure. If the function fails, the named device will have its last error code set appropriately, as long as the device is mounted. </dd></dl>

</div>
</div>
<a class="anchor" id="a70ced5788425a5573183fcc36e517259"></a><!-- doxytag: member="xpsdev.c::xpsdevClearPackage" ref="a70ced5788425a5573183fcc36e517259" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void xpsdevClearPackage </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Disassociate the xpsdev device type from any notion of the "current" package. </p>
<p>Use this function to guard against accidentally mounting an instance of xpsdev with the wrong package management context. If you attempt to mount an xpsdev instance when there is no package context, a PostScript error will occur.</p>
<p>Note that this function does not actually <em>destroy</em> the current package. This only happens when the xpsdev instance is dismounted. </p>

</div>
</div>
<a class="anchor" id="aa6b2c04f6d55ccade7212aea31cede15"></a><!-- doxytag: member="xpsdev.c::xpsdevSetPackage" ref="aa6b2c04f6d55ccade7212aea31cede15" args="(XPSPackageDescription *pPD, XPSPackageStreamManager *pPSM, uint32 fComplete)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void xpsdevSetPackage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__XPSPackageDescription.html">XPSPackageDescription</a> *&nbsp;</td>
          <td class="paramname"> <em>pPD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct__XPSPackageStreamManager.html">XPSPackageStreamManager</a> *&nbsp;</td>
          <td class="paramname"> <em>pPSM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__stdtypes.html#ga8ad23e2333787a214e20a58a284a5a60">uint32</a>&nbsp;</td>
          <td class="paramname"> <em>fComplete</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Establish the package description and stream manager that should be adopted in the device state when the <em>next</em> instance of xpsdev is mounted. </p>
<p>Xpsdev is not a "pure" PostScript device. The context required to set up an instance of xpsdev goes beyond what is possible using simple device parameters. To mount an xpsdev instance successfully, you must call this C function <em>first</em>, and then execute the sequence of PostScript code to mount a new instance of the device. The pointers to the <code>XPSPackageDescription</code> and the <code>XPSPackageStreamManager</code> are then copied into the device state.</p>
<p>Between the call to <code><a class="el" href="xpsdev_8c.html#aa6b2c04f6d55ccade7212aea31cede15" title="Establish the package description and stream manager that should be adopted in the...">xpsdevSetPackage()</a></code> and the call to execute the PostScript code that will mount the device, the two pointers need to be stored in global variables. It is possible to mount multiple instances of xpsdev, but you must take care to mount each instance separately, each time you call <code><a class="el" href="xpsdev_8c.html#aa6b2c04f6d55ccade7212aea31cede15" title="Establish the package description and stream manager that should be adopted in the...">xpsdevSetPackage()</a></code>. If you make a second call to <code><a class="el" href="xpsdev_8c.html#aa6b2c04f6d55ccade7212aea31cede15" title="Establish the package description and stream manager that should be adopted in the...">xpsdevSetPackage()</a></code> before mounting the first instance of the device, the pointers from the first call will be overwritten, causing unexpected behaviour.</p>
<p>When the next xpsdev device is mounted by PostScript code, the supplied <code>XPSPackageDescription</code> will be converted into a "virtual" XPS package, which the RIP can actually interpret and render. Like all devices, the xpsdev instance will have a name, which can be used as the root of the package. So, for example, if the device is called "MyVirtualXPS", the package can be rendered using the following PostScript control sequence:-</p>
<div class="fragment"><pre class="fragment">
       (%MyVirtualXPS%/_rels/.rels) (r) file &lt;&lt; &gt;&gt; xmlexec
   </pre></div><p>Once the device has been mounted, and even while the RIP is processing the package, it is possible to add further documents and pages dynamically. See <code><a class="el" href="xpsdev_8c.html#ace6981257d0106f55e73c3670a48f01c" title="Add a new XPS Fixed Document to an unfinished package.">xpsdevAddFixedDocument()</a></code> and <code><a class="el" href="xpsdev_8c.html#a9f03a386114f62ad7d8ee035d5bc2c88" title="Add a new XPS Fixed Page to an unfinished package.">xpsdevAddFixedPage()</a></code>. When there are no further package parts to be added, call <code><a class="el" href="xpsdev_8c.html#ae3090ca279433c9a491efc15eb12e249" title="Signal that an unfinished package is now complete, and that no further pages or documents...">xpsdevSetPackageComplete()</a></code>, which will notify the RIP that it should not wait for additional parts. Failure to call this function might cause a deadlock in the interpreter. If the package is already complete when supplied to <code><a class="el" href="xpsdev_8c.html#aa6b2c04f6d55ccade7212aea31cede15" title="Establish the package description and stream manager that should be adopted in the...">xpsdevSetPackage()</a></code>, pass <code>TRUE</code> as the <code>fComplete</code> argument.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pPD</em>&nbsp;</td><td>A pointer to the package description. A copy of this pointer will be stored in the device state when the device is mounted. Note that only the pointer value is copied. There will be no deep copy made of the underlying structures. The caller is responsible for managing the memory, and <em>must not</em> free the memory until the device is dismounted.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pPSM</em>&nbsp;</td><td>A pointer to the package stream manager. A copy of this pointer will be stored in the device state when the device is mounted. This memory is managed by the caller, and it <em>most not</em> be freed until the device is dismounted.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fComplete</em>&nbsp;</td><td>A flag indicating whether the package is fully-formed. If this is <code>TRUE</code>, then the XPS package has all of its parts available. If <code>FALSE</code>, then additional parts (such as pages and documents) can be added to the package later with <code><a class="el" href="xpsdev_8c.html#ace6981257d0106f55e73c3670a48f01c" title="Add a new XPS Fixed Document to an unfinished package.">xpsdevAddFixedDocument()</a></code> and <code><a class="el" href="xpsdev_8c.html#a9f03a386114f62ad7d8ee035d5bc2c88" title="Add a new XPS Fixed Page to an unfinished package.">xpsdevAddFixedPage()</a></code>. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ae3090ca279433c9a491efc15eb12e249"></a><!-- doxytag: member="xpsdev.c::xpsdevSetPackageComplete" ref="ae3090ca279433c9a491efc15eb12e249" args="(uint8 *pszDevice)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> xpsdevSetPackageComplete </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__stdtypes.html#ga3c77e3a247345b581bdb6939ffe95a94">uint8</a> *&nbsp;</td>
          <td class="paramname"> <em>pszDevice</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Signal that an unfinished package is now complete, and that no further pages or documents will be added. </p>
<p>This function cannot be called until a named instance of xpsdev has been mounted from PostScript.</p>
<p>This function must be called exactly once if the package was originally specified as being incomplete. Failure to do so may cause a deadlock in the RIP, since it will stall indefinitely, waiting for additional parts.</p>
<p>After calling this function, it is no longer valid to call <code><a class="el" href="xpsdev_8c.html#ace6981257d0106f55e73c3670a48f01c" title="Add a new XPS Fixed Document to an unfinished package.">xpsdevAddFixedDocument()</a></code> or <code><a class="el" href="xpsdev_8c.html#a9f03a386114f62ad7d8ee035d5bc2c88" title="Add a new XPS Fixed Page to an unfinished package.">xpsdevAddFixedPage()</a></code> for the specified device. As soon as the RIP finishes processing the current contents of the XPS package, the job will terminate.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pszDevice</em>&nbsp;</td><td>Nul-terminated name of the xpsdev instance that was mounted from PostScript. This name should <em>not</em> include any delimiting percent characters. A device of this name must have been mounted, otherwise the function will fail.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>TRUE upon success; FALSE upon failure. If the function fails, the named device will have its last error code set appropriately, as long as the device is mounted. </dd></dl>

</div>
</div>
</div>
<hr size="1"><address style="align: right;">
<!-- $HopeName: SWprod_hqnrip!clrip:branding:footer.html(EBDSDK_P.1) $ -->
<!-- Copyright (C) 2007 Global Graphics Software Ltd. All rights reserved. -->
<!-- Global Graphics Software Ltd. Confidential Information. -->

<i><small>For information on other products from Global Graphics, visit <a href="http://www.globalgraphics.com" target="_blank">www.globalgraphics.com</a></small></i></address>
</body>
</html>
