<!-- Copyright (C) 2007 Global Graphics Software Ltd. All rights reserved. -->
<!-- Global Graphics Software Ltd. Confidential Information. -->
<!-- $HopeName: SWprod_hqnrip!clrip:branding:lekit-header.html(EBDSDK_P.1) $ -->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"> <html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1"> <title>Harlequin RIP SDK: xpsbuild.c File Reference</title> <h5 style="align: right;"><a href="http://www.globalgraphics.com" target="_blank"><img src="./gg_logo.gif" alt="Global Graphics logo" align="middle" border=0></a><img src="./spacer.gif">Harlequin RIP SDK Documentation</h5> <link href="doxygen.css" rel="stylesheet" type="text/css"> </head> </html> 
<!-- Generated by Doxygen 1.6.2 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_19043388fc15ddb67e28f7a33621a223.html">skinkit</a>&nbsp;&raquo;&nbsp;<a class="el" href="dir_1a92abee00141eb4bc1b55dcfd46ed15.html">src</a>
  </div>
</div>
<div class="contents">
<h1>xpsbuild.c File Reference</h1>
<p>Implements an API for building XPS package parts using the in-memory virtual filesystem (MFS).  
<a href="#_details">More...</a></p>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;ctype.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="std_8h.html">std.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="hqstr_8h.html">hqstr.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="memfs_8h.html">memfs.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="mem_8h.html">mem.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="xpsbuild_8h.html">xpsbuild.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="swdevice_8h.html">swdevice.h</a>&quot;</code><br/>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct__RelsFileManager.html">_RelsFileManager</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Manages the creation of Relationship tags with a .rels file.  <a href="struct__RelsFileManager.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct__PartNameList.html">_PartNameList</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Simple structure for maintaining a linear list of part names.  <a href="struct__PartNameList.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct__ContentTypesManager.html">_ContentTypesManager</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Manages the creation of Override tags within the global content types streams.  <a href="struct__ContentTypesManager.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct__PageBuildContext.html">_PageBuildContext</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Provides all of the contextual data needed to add a fixed page to the package.  <a href="struct__PageBuildContext.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct__DocumentBuildContext.html">_DocumentBuildContext</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Provides all of the contextual data needed to add a fixed document to the package.  <a href="struct__DocumentBuildContext.html#_details">More...</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct__PackageBuildContext.html">_PackageBuildContext</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Provides all of the contextual data needed to create the fixed document sequence within the package.  <a href="struct__PackageBuildContext.html#_details">More...</a><br/></td></tr>
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4894e12d837aa9baaca7d7362f0b6af0"></a><!-- doxytag: member="xpsbuild.c::XML_LINEBUFFER_SIZE" ref="a4894e12d837aa9baaca7d7362f0b6af0" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xpsbuild_8c.html#a4894e12d837aa9baaca7d7362f0b6af0">XML_LINEBUFFER_SIZE</a>&nbsp;&nbsp;&nbsp;1024</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Number of characters to allocate for a single line of XML text. <br/></td></tr>
<tr><td colspan="2"><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct__RelsFileManager.html">_RelsFileManager</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xpsbuild_8c.html#a8f01709775a1f3d1003b912d04b33372">RelsFileManager</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Manages the creation of Relationship tags with a .rels file.  <a href="#a8f01709775a1f3d1003b912d04b33372"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct__PartNameList.html">_PartNameList</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xpsbuild_8c.html#ad86b50a09383e3c12bbba3fdadc6f007">PartNameList</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Simple structure for maintaining a linear list of part names.  <a href="#ad86b50a09383e3c12bbba3fdadc6f007"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct__ContentTypesManager.html">_ContentTypesManager</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xpsbuild_8c.html#ad6086bf18e794e26ab65d97ae4a66c37">ContentTypesManager</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Manages the creation of Override tags within the global content types streams.  <a href="#ad6086bf18e794e26ab65d97ae4a66c37"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct__PageBuildContext.html">_PageBuildContext</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xpsbuild_8c.html#a108afa0f81d757290447c7726550cb35">PageBuildContext</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Provides all of the contextual data needed to add a fixed page to the package.  <a href="#a108afa0f81d757290447c7726550cb35"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef struct <br class="typebreak"/>
<a class="el" href="struct__DocumentBuildContext.html">_DocumentBuildContext</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xpsbuild_8c.html#a07c7301c977f4f236e1d920a65cd14a3">DocumentBuildContext</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Provides all of the contextual data needed to add a fixed document to the package.  <a href="#a07c7301c977f4f236e1d920a65cd14a3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct__PackageBuildContext.html">_PackageBuildContext</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xpsbuild_8c.html#aea707f66995c10334c2e6e20599f8d8a">PackageBuildContext</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Provides all of the contextual data needed to create the fixed document sequence within the package.  <a href="#aea707f66995c10334c2e6e20599f8d8a"></a><br/></td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xpsbuild_8c.html#a0121dc2befc938c561d44125a1399d97">writeXMLHeader</a> (<a class="el" href="memfs_8h.html#a149dff2dc199b173cd81b48368ca72e2">MFSFILEDESC</a> *pFD, <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> *pDevErr)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write the standard XML header line to the given file.  <a href="#a0121dc2befc938c561d44125a1399d97"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xpsbuild_8c.html#ae865bc2c78d55f9dd9c92c36664c2418">openXMLRelationships</a> (<a class="el" href="struct__RelsFileManager.html">RelsFileManager</a> *pRFM, <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> *pDevErr)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write the standard XML header line and the correct XML opening tag for XPS relationships.  <a href="#ae865bc2c78d55f9dd9c92c36664c2418"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xpsbuild_8c.html#a4118451767f3e3810490e5d193727016">writeXMLRelationship</a> (<a class="el" href="struct__RelsFileManager.html">RelsFileManager</a> *pRFM, <a class="el" href="group__stdtypes.html#ga8ad23e2333787a214e20a58a284a5a60">uint32</a> relType, char *pszTarget, <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> *pDevErr)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add a relationship entry tag to the given rels file, and increment the relationship ID.  <a href="#a4118451767f3e3810490e5d193727016"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xpsbuild_8c.html#a7c6c440dc3972c085c414e9ff515af8f">closeXMLRelationships</a> (<a class="el" href="struct__RelsFileManager.html">RelsFileManager</a> *pRFM, <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> *pDevErr)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write the XML closing tag for a relationships file, and close the file.  <a href="#a7c6c440dc3972c085c414e9ff515af8f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xpsbuild_8c.html#a330cc2b5988b968316b1e5b8e1d56ac3">openFixedDocumentSequence</a> (<a class="el" href="memfs_8h.html#a149dff2dc199b173cd81b48368ca72e2">MFSFILEDESC</a> *pFD, <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> *pDevErr)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write the XML header and opening tag for a FixedDocumentSequence (.fdseq) file.  <a href="#a330cc2b5988b968316b1e5b8e1d56ac3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xpsbuild_8c.html#a7aabf57c5685e238f3f61c9c3c50da68">writeDocumentReference</a> (<a class="el" href="memfs_8h.html#a149dff2dc199b173cd81b48368ca72e2">MFSFILEDESC</a> *pFD, char *pszUriDocument, <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> *pDevErr)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write a DocumentReference element to the given FixedDocumentSequence (.fdseq) file.  <a href="#a7aabf57c5685e238f3f61c9c3c50da68"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xpsbuild_8c.html#ac4ed6d4054e7e47169a34a95ea22851d">closeFixedDocumentSequence</a> (<a class="el" href="memfs_8h.html#a149dff2dc199b173cd81b48368ca72e2">MFSFILEDESC</a> *pFD, <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> *pDevErr)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write the XML closing tag to the given FixedDocumentSequence (.fdseq) file, and close the file.  <a href="#ac4ed6d4054e7e47169a34a95ea22851d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xpsbuild_8c.html#acae2cc11d85160e7e4a1e7895976f949">openFixedDocument</a> (<a class="el" href="memfs_8h.html#a149dff2dc199b173cd81b48368ca72e2">MFSFILEDESC</a> *pFD, <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> *pDevErr)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write the XML header and opening tag for a FixedDocument (.fdoc) file.  <a href="#acae2cc11d85160e7e4a1e7895976f949"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xpsbuild_8c.html#a49dbb45502758a03932bda1420f1be4c">writePageReference</a> (<a class="el" href="memfs_8h.html#a149dff2dc199b173cd81b48368ca72e2">MFSFILEDESC</a> *pFD, char *pszUriPage, <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> *pDevErr)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write a PageContent element to the given FixedDocument (.fdoc) file.  <a href="#a49dbb45502758a03932bda1420f1be4c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xpsbuild_8c.html#a800ab262c75547a8d7569c3b1c4cc6fc">closeFixedDocument</a> (<a class="el" href="memfs_8h.html#a149dff2dc199b173cd81b48368ca72e2">MFSFILEDESC</a> *pFD, <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> *pDevErr)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write the XML closing tag to the given FixedDocument (.fdoc) file, and close the file.  <a href="#a800ab262c75547a8d7569c3b1c4cc6fc"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xpsbuild_8c.html#a9ee19af916b267dc5205253b135a41ed">openContentTypes</a> (<a class="el" href="struct__ContentTypesManager.html">ContentTypesManager</a> *pCTM, <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> *pDevErr)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write the XML header and opening tag for a Content Types file.  <a href="#a9ee19af916b267dc5205253b135a41ed"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xpsbuild_8c.html#a8fcddfb0d1c81359a8e219a05bd5f6d6">writeContentTypeOverride</a> (<a class="el" href="struct__ContentTypesManager.html">ContentTypesManager</a> *pCTM, char *pszPartName, char *pszType, <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> *pDevErr)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write an Override element into the given Content Types file.  <a href="#a8fcddfb0d1c81359a8e219a05bd5f6d6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xpsbuild_8c.html#a4662e1d1b01bbb34ea4a2e0979553422">closeContentTypes</a> (<a class="el" href="struct__ContentTypesManager.html">ContentTypesManager</a> *pCTM, <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> *pDevErr)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write the XML closing tag to the given Content Types file, and close the file.  <a href="#a4662e1d1b01bbb34ea4a2e0979553422"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xpsbuild_8c.html#afdeea660cfa7dc3e0ba03e0a0f2bbef3">makePartURI</a> (<a class="el" href="group__stdtypes.html#ga3c77e3a247345b581bdb6939ffe95a94">uint8</a> *pszPreSpecifiedUri, <a class="el" href="group__stdtypes.html#ga8ad23e2333787a214e20a58a284a5a60">uint32</a> partType, <a class="el" href="group__stdtypes.html#ga8ad23e2333787a214e20a58a284a5a60">uint32</a> iDoc, <a class="el" href="group__stdtypes.html#ga8ad23e2333787a214e20a58a284a5a60">uint32</a> iPage, <a class="el" href="group__stdtypes.html#ga8ad23e2333787a214e20a58a284a5a60">uint32</a> fRels, char *pszURI)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Build the appropriate URI for a part within the package.  <a href="#afdeea660cfa7dc3e0ba03e0a0f2bbef3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xpsbuild_8c.html#af23ddb990f65f9b0ef9498e3b8036297">makeRelsNameFromPartName</a> (char *pszPartName, char *pszRelsName)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Utility function allowing <code><a class="el" href="xpsbuild_8c.html#afdeea660cfa7dc3e0ba03e0a0f2bbef3" title="Build the appropriate URI for a part within the package.">makePartURI()</a></code> to construct relationship names from pre-specified part names.  <a href="#af23ddb990f65f9b0ef9498e3b8036297"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xpsbuild_8c.html#a69b79bfd6989d2eb4b5423a6c42628bb">addURIContextMapping</a> (<a class="el" href="struct__URIContextMappingsList.html">URIContextMappingsList</a> *pList, char *pszURI, <a class="el" href="group__stdtypes.html#ga8ad23e2333787a214e20a58a284a5a60">uint32</a> iDoc, <a class="el" href="group__stdtypes.html#ga8ad23e2333787a214e20a58a284a5a60">uint32</a> iPage, <a class="el" href="group__stdtypes.html#ga8ad23e2333787a214e20a58a284a5a60">uint32</a> resourceType, <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> *pDevErr)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Copy the given context information into a freshly-allocated <code>URIContextMapping</code> structure, and link it to the end of the given list.  <a href="#a69b79bfd6989d2eb4b5423a6c42628bb"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xpsbuild_8c.html#a93edfe0d103f5e559509678ace7663f9">buildFixedPage</a> (<a class="el" href="struct__PageBuildContext.html">PageBuildContext</a> *pContext, <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> *pDevErr)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add a new fixed page to the package (with explicit context).  <a href="#a93edfe0d103f5e559509678ace7663f9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xpsbuild_8c.html#ae3ca2185b4d07d48a78ccf5d6d41962d">startFixedDocumentBuild</a> (<a class="el" href="struct__PackageBuildContext.html">PackageBuildContext</a> *pPC, <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> *pDevErr, <a class="el" href="struct__XPSDocumentDescription.html">XPSDocumentDescription</a> *pDoc)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Begin a new Fixed Document context for the package.  <a href="#ae3ca2185b4d07d48a78ccf5d6d41962d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xpsbuild_8c.html#a46c902b78c96d0408105b77dbbcfe01d">endFixedDocumentBuild</a> (<a class="el" href="struct__PackageBuildContext.html">PackageBuildContext</a> *pPC, <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> *pDevErr)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">End the current Fixed Document context.  <a href="#a46c902b78c96d0408105b77dbbcfe01d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xpsbuild_8c.html#a1086ddde5c5faac9c0071344e7c5db18">startFixedDocumentSequenceBuild</a> (<a class="el" href="struct__PackageBuildContext.html">PackageBuildContext</a> *pContext, <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> *pDevErr)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Begin the Fixed Document Sequence context for the package.  <a href="#a1086ddde5c5faac9c0071344e7c5db18"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xpsbuild_8c.html#a5728956f35e8f8f72900cc95dfc54752">endFixedDocumentSequenceBuild</a> (<a class="el" href="struct__PackageBuildContext.html">PackageBuildContext</a> *pContext, <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> *pDevErr)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">End the Fixed Document Sequence context for the package.  <a href="#a5728956f35e8f8f72900cc95dfc54752"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xpsbuild_8c.html#ae520fa1adb9a5eadbc8edd2f258c9029">addFixedPage</a> (<a class="el" href="struct__PackageBuildContext.html">PackageBuildContext</a> *pContext, <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> *pDevErr, <a class="el" href="struct__XPSPageDescription.html">XPSPageDescription</a> *pPage)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Adds a Fixed Page in the context of the currently-open document.  <a href="#ae520fa1adb9a5eadbc8edd2f258c9029"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct__URIContextMapping.html">URIContextMapping</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xpsbuild_8c.html#a6bd614cbd1aa9b5c4768079285f1a0c3">lookupContextMapping</a> (<a class="el" href="struct__URIContextMappingsList.html">URIContextMappingsList</a> *pMappings, <a class="el" href="group__stdtypes.html#ga3c77e3a247345b581bdb6939ffe95a94">uint8</a> *pszPartName)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Helper utility for looking up a single entry in a list of URI context mappings.  <a href="#a6bd614cbd1aa9b5c4768079285f1a0c3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xpsbuild_8c.html#a1ac54b1c8e97f3a7e092558fc301a03e">buildXPSPackageInMemory</a> (<a class="el" href="struct__XPSPackageDescription.html">XPSPackageDescription</a> *pXPD, <a class="el" href="struct__URIContextMappingsList.html">URIContextMappingsList</a> *pMappings, <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> *pDevErr)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Build an XPS package in memory, and return a pointer to the build context.  <a href="#a1ac54b1c8e97f3a7e092558fc301a03e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct__MFSNODE.html">MFSNODE</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xpsbuild_8c.html#a0ff279061f9b23046343f07a2d190d17">getXPSPackageRoot</a> (void *pContext)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the root node of RAM filesystem storage for the XPS package.  <a href="#a0ff279061f9b23046343f07a2d190d17"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xpsbuild_8c.html#ac5c497c27983fd53b384778faf045039">addFixedPageToXPSPackage</a> (void *pContext, <a class="el" href="struct__XPSPageDescription.html">XPSPageDescription</a> *pPage, <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> *pDevErr)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add a new XPS Fixed Page to a package.  <a href="#ac5c497c27983fd53b384778faf045039"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xpsbuild_8c.html#ab120896495d835af48a58606116f62c5">addFixedDocumentToXPSPackage</a> (void *pContext, <a class="el" href="struct__XPSDocumentDescription.html">XPSDocumentDescription</a> *pDocument, <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> *pDevErr)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add a new XPS Fixed Document to a package.  <a href="#ab120896495d835af48a58606116f62c5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xpsbuild_8c.html#a05aa11a7ec116780d7d26bdd750eeb44">commitXPSPackageInMemory</a> (void *pContext, <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> *pDevErr)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Signal that an XPS package is complete.  <a href="#a05aa11a7ec116780d7d26bdd750eeb44"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xpsbuild_8c.html#a435ff8580afc32e6f63e19e77a3c3388">freeXPSPackageInMemory</a> (void *pContext, <a class="el" href="struct__URIContextMappingsList.html">URIContextMappingsList</a> *pMappings)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Release all memory associated with an XPS package that was previously built with <code><a class="el" href="xpsbuild_8c.html#a1ac54b1c8e97f3a7e092558fc301a03e" title="Build an XPS package in memory, and return a pointer to the build context.">buildXPSPackageInMemory()</a></code>.  <a href="#a435ff8580afc32e6f63e19e77a3c3388"></a><br/></td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac3d4ccfc411f7d2fb3b3a5bd3b34fe53"></a><!-- doxytag: member="xpsbuild.c::pszBootstrapFile" ref="ac3d4ccfc411f7d2fb3b3a5bd3b34fe53" args="" -->
static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xpsbuild_8c.html#ac3d4ccfc411f7d2fb3b3a5bd3b34fe53">pszBootstrapFile</a> = &quot;/_rels/.rels&quot;</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Standard fixed part name for the initial boot file in an XPS package. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a69c95164c19a6a245d4f7edbd1947a25"></a><!-- doxytag: member="xpsbuild.c::pszContentTypesFile" ref="a69c95164c19a6a245d4f7edbd1947a25" args="" -->
static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xpsbuild_8c.html#a69c95164c19a6a245d4f7edbd1947a25">pszContentTypesFile</a> = &quot;/[Content_Types].xml&quot;</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Standard fixed part name for the global content types file. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7c90b61dcf0ed0a6d4321113710e3aac"></a><!-- doxytag: member="xpsbuild.c::pszXMLHeader" ref="a7c90b61dcf0ed0a6d4321113710e3aac" args="" -->
static char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="xpsbuild_8c.html#a7c90b61dcf0ed0a6d4321113710e3aac">pszXMLHeader</a> = &quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;utf-8\&quot;?&gt;\n\n&quot;</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Standard XML header line, assuming UTF-8 encoding. <br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Implements an API for building XPS package parts using the in-memory virtual filesystem (MFS). </p>
<hr/><h2>Typedef Documentation</h2>
<a class="anchor" id="ad6086bf18e794e26ab65d97ae4a66c37"></a><!-- doxytag: member="xpsbuild.c::ContentTypesManager" ref="ad6086bf18e794e26ab65d97ae4a66c37" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct__ContentTypesManager.html">_ContentTypesManager</a>  <a class="el" href="struct__ContentTypesManager.html">ContentTypesManager</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Manages the creation of Override tags within the global content types streams. </p>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="xpsbuild_8c.html#a9ee19af916b267dc5205253b135a41ed" title="Write the XML header and opening tag for a Content Types file.">openContentTypes()</a> </dd>
<dd>
<a class="el" href="xpsbuild_8c.html#a8fcddfb0d1c81359a8e219a05bd5f6d6" title="Write an Override element into the given Content Types file.">writeContentTypeOverride()</a> </dd>
<dd>
<a class="el" href="xpsbuild_8c.html#a4662e1d1b01bbb34ea4a2e0979553422" title="Write the XML closing tag to the given Content Types file, and close the file.">closeContentTypes()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="a07c7301c977f4f236e1d920a65cd14a3"></a><!-- doxytag: member="xpsbuild.c::DocumentBuildContext" ref="a07c7301c977f4f236e1d920a65cd14a3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct__DocumentBuildContext.html">_DocumentBuildContext</a>  <a class="el" href="struct__DocumentBuildContext.html">DocumentBuildContext</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Provides all of the contextual data needed to add a fixed document to the package. </p>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="xpsbuild_8c.html#ae3ca2185b4d07d48a78ccf5d6d41962d" title="Begin a new Fixed Document context for the package.">startFixedDocumentBuild()</a> </dd>
<dd>
<a class="el" href="xpsbuild_8c.html#a46c902b78c96d0408105b77dbbcfe01d" title="End the current Fixed Document context.">endFixedDocumentBuild()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="aea707f66995c10334c2e6e20599f8d8a"></a><!-- doxytag: member="xpsbuild.c::PackageBuildContext" ref="aea707f66995c10334c2e6e20599f8d8a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct__PackageBuildContext.html">_PackageBuildContext</a>  <a class="el" href="struct__PackageBuildContext.html">PackageBuildContext</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Provides all of the contextual data needed to create the fixed document sequence within the package. </p>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="xpsbuild_8c.html#a1086ddde5c5faac9c0071344e7c5db18" title="Begin the Fixed Document Sequence context for the package.">startFixedDocumentSequenceBuild()</a> </dd>
<dd>
<a class="el" href="xpsbuild_8c.html#a5728956f35e8f8f72900cc95dfc54752" title="End the Fixed Document Sequence context for the package.">endFixedDocumentSequenceBuild()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="a108afa0f81d757290447c7726550cb35"></a><!-- doxytag: member="xpsbuild.c::PageBuildContext" ref="a108afa0f81d757290447c7726550cb35" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct__PageBuildContext.html">_PageBuildContext</a>  <a class="el" href="struct__PageBuildContext.html">PageBuildContext</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Provides all of the contextual data needed to add a fixed page to the package. </p>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="xpsbuild_8c.html#a93edfe0d103f5e559509678ace7663f9" title="Add a new fixed page to the package (with explicit context).">buildFixedPage()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="ad86b50a09383e3c12bbba3fdadc6f007"></a><!-- doxytag: member="xpsbuild.c::PartNameList" ref="ad86b50a09383e3c12bbba3fdadc6f007" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct__PartNameList.html">_PartNameList</a>  <a class="el" href="struct__PartNameList.html">PartNameList</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Simple structure for maintaining a linear list of part names. </p>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="xpsbuild_8c.html#ad6086bf18e794e26ab65d97ae4a66c37" title="Manages the creation of Override tags within the global content types streams.">ContentTypesManager</a> </dd></dl>

</div>
</div>
<a class="anchor" id="a8f01709775a1f3d1003b912d04b33372"></a><!-- doxytag: member="xpsbuild.c::RelsFileManager" ref="a8f01709775a1f3d1003b912d04b33372" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct__RelsFileManager.html">_RelsFileManager</a>  <a class="el" href="struct__RelsFileManager.html">RelsFileManager</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Manages the creation of Relationship tags with a .rels file. </p>
<p>Each relationship has an Id attribute, which must be unique within the file. This requirement is satisfied by the <code>id</code> field of this structure, which is incremented each time a tag is written.</p>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="xpsbuild_8c.html#ae865bc2c78d55f9dd9c92c36664c2418" title="Write the standard XML header line and the correct XML opening tag for XPS relationships...">openXMLRelationships()</a> </dd>
<dd>
<a class="el" href="xpsbuild_8c.html#a4118451767f3e3810490e5d193727016" title="Add a relationship entry tag to the given rels file, and increment the relationship...">writeXMLRelationship()</a> </dd>
<dd>
<a class="el" href="xpsbuild_8c.html#a7c6c440dc3972c085c414e9ff515af8f" title="Write the XML closing tag for a relationships file, and close the file.">closeXMLRelationships()</a> </dd></dl>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ab120896495d835af48a58606116f62c5"></a><!-- doxytag: member="xpsbuild.c::addFixedDocumentToXPSPackage" ref="ab120896495d835af48a58606116f62c5" args="(void *pContext, XPSDocumentDescription *pDocument, int32 *pDevErr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> addFixedDocumentToXPSPackage </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>pContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct__XPSDocumentDescription.html">XPSDocumentDescription</a> *&nbsp;</td>
          <td class="paramname"> <em>pDocument</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> *&nbsp;</td>
          <td class="paramname"> <em>pDevErr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Add a new XPS Fixed Document to a package. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pContext</em>&nbsp;</td><td>A pointer to the build context. This <em>must</em> be a pointer that was returned from an earlier, successful call to <code><a class="el" href="xpsbuild_8c.html#a1ac54b1c8e97f3a7e092558fc301a03e" title="Build an XPS package in memory, and return a pointer to the build context.">buildXPSPackageInMemory()</a></code>..</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pDocument</em>&nbsp;</td><td>A pointer to a description of the new document, which may include one or more pages. It is permissible to add a new document /e before adding any of its pages. This, in fact, would be typical when integrating the RIP with a pipeline architecture. It might be better to think of this function as /e starting a new document, rather than adding it in its entirity (although the interface also allows that). Subsequent calls to <code><a class="el" href="xpsbuild_8c.html#ac5c497c27983fd53b384778faf045039" title="Add a new XPS Fixed Page to a package.">addFixedPageToXPSPackage()</a></code> can be considered as adding pages to this document, until a further document is added, or the package is closed.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pDevErr</em>&nbsp;</td><td>If there is a failure, this parameter will receive a standard error code, according to the conventions of the Core RIP Device Interface. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ae520fa1adb9a5eadbc8edd2f258c9029"></a><!-- doxytag: member="xpsbuild.c::addFixedPage" ref="ae520fa1adb9a5eadbc8edd2f258c9029" args="(PackageBuildContext *pContext, int32 *pDevErr, XPSPageDescription *pPage)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> addFixedPage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__PackageBuildContext.html">PackageBuildContext</a> *&nbsp;</td>
          <td class="paramname"> <em>pContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> *&nbsp;</td>
          <td class="paramname"> <em>pDevErr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct__XPSPageDescription.html">XPSPageDescription</a> *&nbsp;</td>
          <td class="paramname"> <em>pPage</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Adds a Fixed Page in the context of the currently-open document. </p>
<p>This function delegates to <code><a class="el" href="xpsbuild_8c.html#a93edfe0d103f5e559509678ace7663f9" title="Add a new fixed page to the package (with explicit context).">buildFixedPage()</a></code>, having first established the necessary PageBuildContext.</p>
<p>It is illegal to call this function without a currently-open document context, which must have been established by an earlier call to <code><a class="el" href="xpsbuild_8c.html#ae3ca2185b4d07d48a78ccf5d6d41962d" title="Begin a new Fixed Document context for the package.">startFixedDocumentBuild()</a></code>.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pContext</em>&nbsp;</td><td>The build context.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pDevErr</em>&nbsp;</td><td>Receives a standard core device error code if there is a failure.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pPage</em>&nbsp;</td><td>Pointer to a description of the page, and the resources used by it.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Zero on success; -1 on failure. </dd></dl>

</div>
</div>
<a class="anchor" id="ac5c497c27983fd53b384778faf045039"></a><!-- doxytag: member="xpsbuild.c::addFixedPageToXPSPackage" ref="ac5c497c27983fd53b384778faf045039" args="(void *pContext, XPSPageDescription *pPage, int32 *pDevErr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> addFixedPageToXPSPackage </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>pContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct__XPSPageDescription.html">XPSPageDescription</a> *&nbsp;</td>
          <td class="paramname"> <em>pPage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> *&nbsp;</td>
          <td class="paramname"> <em>pDevErr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Add a new XPS Fixed Page to a package. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pContext</em>&nbsp;</td><td>A pointer to the build context. This <em>must</em> be a pointer that was returned from an earlier, successful call to <code><a class="el" href="xpsbuild_8c.html#a1ac54b1c8e97f3a7e092558fc301a03e" title="Build an XPS package in memory, and return a pointer to the build context.">buildXPSPackageInMemory()</a></code>..</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pPage</em>&nbsp;</td><td>A pointer to a description of the new page, including the URIs and content types of all resources used by the page. This interface does not support incremental process at any level finer than a single page. For instance, it is not possible to add further resource URIs or content types for a page, after calling this function.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pDevErr</em>&nbsp;</td><td>If there is a failure, this parameter will receive a standard error code, according to the conventions of the Core RIP Device Interface. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a69b79bfd6989d2eb4b5423a6c42628bb"></a><!-- doxytag: member="xpsbuild.c::addURIContextMapping" ref="a69b79bfd6989d2eb4b5423a6c42628bb" args="(URIContextMappingsList *pList, char *pszURI, uint32 iDoc, uint32 iPage, uint32 resourceType, int32 *pDevErr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> addURIContextMapping </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__URIContextMappingsList.html">URIContextMappingsList</a> *&nbsp;</td>
          <td class="paramname"> <em>pList</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>pszURI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__stdtypes.html#ga8ad23e2333787a214e20a58a284a5a60">uint32</a>&nbsp;</td>
          <td class="paramname"> <em>iDoc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__stdtypes.html#ga8ad23e2333787a214e20a58a284a5a60">uint32</a>&nbsp;</td>
          <td class="paramname"> <em>iPage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__stdtypes.html#ga8ad23e2333787a214e20a58a284a5a60">uint32</a>&nbsp;</td>
          <td class="paramname"> <em>resourceType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> *&nbsp;</td>
          <td class="paramname"> <em>pDevErr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Copy the given context information into a freshly-allocated <code>URIContextMapping</code> structure, and link it to the end of the given list. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pList</em>&nbsp;</td><td>The list of mappings, to which the new mapping element will be added.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pszURI</em>&nbsp;</td><td>Copied into the mapping structure.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>iDoc</em>&nbsp;</td><td>Copied into the mapping structure.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>iPage</em>&nbsp;</td><td>Copied into the mapping structure.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>resourceType</em>&nbsp;</td><td>Copied into the mapping structure.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pDevErr</em>&nbsp;</td><td>Receives a standard core device error code if there is a failure.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>If the function succeeds, the return value is zero. If the function fails, the return value is -1. </dd></dl>

</div>
</div>
<a class="anchor" id="a93edfe0d103f5e559509678ace7663f9"></a><!-- doxytag: member="xpsbuild.c::buildFixedPage" ref="a93edfe0d103f5e559509678ace7663f9" args="(PageBuildContext *pContext, int32 *pDevErr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> buildFixedPage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__PageBuildContext.html">PageBuildContext</a> *&nbsp;</td>
          <td class="paramname"> <em>pContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> *&nbsp;</td>
          <td class="paramname"> <em>pDevErr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Add a new fixed page to the package (with explicit context). </p>
<p>The parent .fdoc file is assumed to already exist. This function will add a new PageContent element to it, and leave the file open.</p>
<p>This function will also add the necessary required relationships and content types for all resources used by the page. A .rels file for the page will be created, populated and closed. The content types file may be modified, and will be left open.</p>
<p>See also <code><a class="el" href="xpsbuild_8c.html#ae520fa1adb9a5eadbc8edd2f258c9029" title="Adds a Fixed Page in the context of the currently-open document.">addFixedPage()</a></code>, which performs the same function, but creates the <code>PageBuildContext</code> automatically from the current state of the package.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pContext</em>&nbsp;</td><td>Pointer to the contextual information needed to position this page within the file tree.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pDevErr</em>&nbsp;</td><td>Receives a standard core device error code if there is a failure.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>If the function succeeds, the return value is zero. If the function fails, the return value is -1. </dd></dl>

</div>
</div>
<a class="anchor" id="a1ac54b1c8e97f3a7e092558fc301a03e"></a><!-- doxytag: member="xpsbuild.c::buildXPSPackageInMemory" ref="a1ac54b1c8e97f3a7e092558fc301a03e" args="(XPSPackageDescription *pXPD, URIContextMappingsList *pMappings, int32 *pDevErr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* buildXPSPackageInMemory </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__XPSPackageDescription.html">XPSPackageDescription</a> *&nbsp;</td>
          <td class="paramname"> <em>pXPD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct__URIContextMappingsList.html">URIContextMappingsList</a> *&nbsp;</td>
          <td class="paramname"> <em>pMappings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> *&nbsp;</td>
          <td class="paramname"> <em>pDevErr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Build an XPS package in memory, and return a pointer to the build context. </p>
<p>Use <code><a class="el" href="xpsbuild_8c.html#a435ff8580afc32e6f63e19e77a3c3388" title="Release all memory associated with an XPS package that was previously built with...">freeXPSPackageInMemory()</a></code> to completely delete the package when it is no longer needed. Failure to do this will incur memory leaks.</p>
<p>XPS Packages built using this function are built using the Memory File System (MFS). Therefore, they only persist while the host process is alive. The root directory of the package is returned by <code><a class="el" href="xpsbuild_8c.html#a0ff279061f9b23046343f07a2d190d17" title="Returns the root node of RAM filesystem storage for the XPS package.">getXPSPackageRoot()</a></code>. This root directory should be used to mount a new instance of the XPS input device (<a class="el" href="xpsdev_8c.html">xpsdev.c</a>). It is then possible to render the package using the <code>xmlexec</code> operator, using the "_rels/.rels" filename to bootstrap the interpretation.</p>
<p>It is possible to add further pages and documents to the package while it is being interpreted. The XPS input device arranges to automatically block the interpreter when the RIP reaches a part that is not yet available. For this reason, it is <em>vital</em> to call the <code><a class="el" href="xpsbuild_8c.html#a05aa11a7ec116780d7d26bdd750eeb44" title="Signal that an XPS package is complete.">commitXPSPackageInMemory()</a></code> function when there are no more parts to be added. Failure to call this function will cause the RIP to stall indefinitely, expecting further parts to be added. The functions <code><a class="el" href="xpsbuild_8c.html#ac5c497c27983fd53b384778faf045039" title="Add a new XPS Fixed Page to a package.">addFixedPageToXPSPackage()</a></code> and <code><a class="el" href="xpsbuild_8c.html#ab120896495d835af48a58606116f62c5" title="Add a new XPS Fixed Document to a package.">addFixedDocumentToXPSPackage()</a></code> can be used to extend the package while the RIP is processing it. This method of delivery is very useful when integrating the RIP with pipelined architectures, such as the XPSDrv Filter Pipeline. When pre-RIP components are generating package parts incrementally, it is more efficient to start RIPping the package immediately, rather than to wait until all parts are available.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pXPD</em>&nbsp;</td><td>Pointer to the complete description of the XPS package.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pMappings</em>&nbsp;</td><td>Pointer to an empty list of URI context mappings. The list will be populated by this function, if it succeeds. The caller should not free this list, or any of its elements. The list as a whole will be freed by the later call to <code><a class="el" href="xpsbuild_8c.html#a435ff8580afc32e6f63e19e77a3c3388" title="Release all memory associated with an XPS package that was previously built with...">freeXPSPackageInMemory()</a></code>, which the caller is expected to make when the package is no longer required.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pDevErr</em>&nbsp;</td><td>If there is a failure, this parameter will receive a standard error code, according to the conventions of the Core RIP Device Interface.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>If the function succeeds, the return value is a pointer to a build context. This is an opaque token that must be used in all later calls to <code><a class="el" href="xpsbuild_8c.html#ab120896495d835af48a58606116f62c5" title="Add a new XPS Fixed Document to a package.">addFixedDocumentToXPSPackage()</a></code>, <code><a class="el" href="xpsbuild_8c.html#ac5c497c27983fd53b384778faf045039" title="Add a new XPS Fixed Page to a package.">addFixedPageToXPSPackage()</a></code>, <code><a class="el" href="xpsbuild_8c.html#a0ff279061f9b23046343f07a2d190d17" title="Returns the root node of RAM filesystem storage for the XPS package.">getXPSPackageRoot()</a></code>, <code><a class="el" href="xpsbuild_8c.html#a05aa11a7ec116780d7d26bdd750eeb44" title="Signal that an XPS package is complete.">commitXPSPackageInMemory()</a></code> and <code><a class="el" href="xpsbuild_8c.html#a435ff8580afc32e6f63e19e77a3c3388" title="Release all memory associated with an XPS package that was previously built with...">freeXPSPackageInMemory()</a></code>. If the function fails, the return value is <code>NULL</code>. </dd></dl>

</div>
</div>
<a class="anchor" id="a4662e1d1b01bbb34ea4a2e0979553422"></a><!-- doxytag: member="xpsbuild.c::closeContentTypes" ref="a4662e1d1b01bbb34ea4a2e0979553422" args="(ContentTypesManager *pCTM, int32 *pDevErr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> closeContentTypes </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__ContentTypesManager.html">ContentTypesManager</a> *&nbsp;</td>
          <td class="paramname"> <em>pCTM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> *&nbsp;</td>
          <td class="paramname"> <em>pDevErr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Write the XML closing tag to the given Content Types file, and close the file. </p>
<p>This function will always close the underlying file descriptor, even if there is an error in writing the tag.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pCTM</em>&nbsp;</td><td>Structure managing the addition of Override entries, which also contains a handle to the [Content_Types].xml file itself.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pDevErr</em>&nbsp;</td><td>Receives a standard core device error code if there is a failure.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The number of bytes of data written to the file, or -1 if there has been an error. </dd></dl>

</div>
</div>
<a class="anchor" id="a800ab262c75547a8d7569c3b1c4cc6fc"></a><!-- doxytag: member="xpsbuild.c::closeFixedDocument" ref="a800ab262c75547a8d7569c3b1c4cc6fc" args="(MFSFILEDESC *pFD, int32 *pDevErr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> closeFixedDocument </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="memfs_8h.html#a149dff2dc199b173cd81b48368ca72e2">MFSFILEDESC</a> *&nbsp;</td>
          <td class="paramname"> <em>pFD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> *&nbsp;</td>
          <td class="paramname"> <em>pDevErr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Write the XML closing tag to the given FixedDocument (.fdoc) file, and close the file. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pFD</em>&nbsp;</td><td>Open handle to the .fdoc file.</td></tr>
  </table>
  </dd>
</dl>
<p>This function will always close the underlying file descriptor, even if there is an error in writing the tag.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pDevErr</em>&nbsp;</td><td>Receives a standard core device error code if there is a failure.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The number of bytes of data written to the file, or -1 if there has been an error. </dd></dl>

</div>
</div>
<a class="anchor" id="ac4ed6d4054e7e47169a34a95ea22851d"></a><!-- doxytag: member="xpsbuild.c::closeFixedDocumentSequence" ref="ac4ed6d4054e7e47169a34a95ea22851d" args="(MFSFILEDESC *pFD, int32 *pDevErr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> closeFixedDocumentSequence </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="memfs_8h.html#a149dff2dc199b173cd81b48368ca72e2">MFSFILEDESC</a> *&nbsp;</td>
          <td class="paramname"> <em>pFD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> *&nbsp;</td>
          <td class="paramname"> <em>pDevErr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Write the XML closing tag to the given FixedDocumentSequence (.fdseq) file, and close the file. </p>
<p>This function will always close the underlying file descriptor, even if there is an error in writing the tag.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pFD</em>&nbsp;</td><td>Open handle to the .fdseq file.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pDevErr</em>&nbsp;</td><td>Receives a standard core device error code if there is a failure.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The number of bytes of data written to the file, or -1 if there has been an error. </dd></dl>

</div>
</div>
<a class="anchor" id="a7c6c440dc3972c085c414e9ff515af8f"></a><!-- doxytag: member="xpsbuild.c::closeXMLRelationships" ref="a7c6c440dc3972c085c414e9ff515af8f" args="(RelsFileManager *pRFM, int32 *pDevErr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> closeXMLRelationships </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__RelsFileManager.html">RelsFileManager</a> *&nbsp;</td>
          <td class="paramname"> <em>pRFM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> *&nbsp;</td>
          <td class="paramname"> <em>pDevErr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Write the XML closing tag for a relationships file, and close the file. </p>
<p>This function will always close the underlying file descriptor, even if there is an error in writing the tag.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pRFM</em>&nbsp;</td><td>Management structure for the relationships file. The function will set the <code>pFD</code> member of this structure to <code>NULL</code>, to ensure that the file descriptor is not used again.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pDevErr</em>&nbsp;</td><td>Receives a standard core device error code if there is a failure.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The number of bytes of data written to the file, or -1 if there has been an error. </dd></dl>

</div>
</div>
<a class="anchor" id="a05aa11a7ec116780d7d26bdd750eeb44"></a><!-- doxytag: member="xpsbuild.c::commitXPSPackageInMemory" ref="a05aa11a7ec116780d7d26bdd750eeb44" args="(void *pContext, int32 *pDevErr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void commitXPSPackageInMemory </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>pContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> *&nbsp;</td>
          <td class="paramname"> <em>pDevErr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Signal that an XPS package is complete. </p>
<p>This function should be called when there are no further pages or documents to be added to the package.</p>
<p>The RIP cannot finish rendering an XPS package until this function has been called. Even if the initial package description is complete when passed to <code><a class="el" href="xpsbuild_8c.html#a1ac54b1c8e97f3a7e092558fc301a03e" title="Build an XPS package in memory, and return a pointer to the build context.">buildXPSPackageInMemory()</a></code>, it is still necessary to call <code><a class="el" href="xpsbuild_8c.html#a05aa11a7ec116780d7d26bdd750eeb44" title="Signal that an XPS package is complete.">commitXPSPackageInMemory()</a></code> afterwards. Failure to call this function will cause a deadlock in the RIP.</p>
<p>Once this function has been called for a particular XPS package, it is no longer legal to add any further contents to the package with <code><a class="el" href="xpsbuild_8c.html#ac5c497c27983fd53b384778faf045039" title="Add a new XPS Fixed Page to a package.">addFixedPageToXPSPackage()</a></code> or <code><a class="el" href="xpsbuild_8c.html#ab120896495d835af48a58606116f62c5" title="Add a new XPS Fixed Document to a package.">addFixedDocumentToXPSPackage()</a></code>. Any attempt to do so may have undesirable consequences.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pContext</em>&nbsp;</td><td>A pointer to the build context. This <em>must</em> be a pointer that was returned from an earlier, successful call to <code><a class="el" href="xpsbuild_8c.html#a1ac54b1c8e97f3a7e092558fc301a03e" title="Build an XPS package in memory, and return a pointer to the build context.">buildXPSPackageInMemory()</a></code>.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pDevErr</em>&nbsp;</td><td>If there is a failure, this parameter will receive a standard error code, according to the conventions of the Core RIP Device Interface. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a46c902b78c96d0408105b77dbbcfe01d"></a><!-- doxytag: member="xpsbuild.c::endFixedDocumentBuild" ref="a46c902b78c96d0408105b77dbbcfe01d" args="(PackageBuildContext *pPC, int32 *pDevErr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> endFixedDocumentBuild </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__PackageBuildContext.html">PackageBuildContext</a> *&nbsp;</td>
          <td class="paramname"> <em>pPC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> *&nbsp;</td>
          <td class="paramname"> <em>pDevErr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>End the current Fixed Document context. </p>
<p>This function writes the closing FixedDocument XML tag to the current .fdoc file, and closes the file.</p>
<p>It is not legal to call this function if there is no currently-open Fixed Document. A prior document context must first have been created by <code><a class="el" href="xpsbuild_8c.html#ae3ca2185b4d07d48a78ccf5d6d41962d" title="Begin a new Fixed Document context for the package.">startFixedDocumentBuild()</a></code>. Remember also that the XPS specification does not allow a Fixed Document to be empty (that is, have zero pages). This function <em>will not</em> enforce that, but the RIP will fail to process the package later if it does not conform to the specification.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pPC</em>&nbsp;</td><td>The build context.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pDevErr</em>&nbsp;</td><td>Receives a standard core device error code if there is a failure.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Zero on success; -1 on failure. </dd></dl>

</div>
</div>
<a class="anchor" id="a5728956f35e8f8f72900cc95dfc54752"></a><!-- doxytag: member="xpsbuild.c::endFixedDocumentSequenceBuild" ref="a5728956f35e8f8f72900cc95dfc54752" args="(PackageBuildContext *pContext, int32 *pDevErr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> endFixedDocumentSequenceBuild </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__PackageBuildContext.html">PackageBuildContext</a> *&nbsp;</td>
          <td class="paramname"> <em>pContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> *&nbsp;</td>
          <td class="paramname"> <em>pDevErr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>End the Fixed Document Sequence context for the package. </p>
<p>This function writes the closing FixedDocumentSequence XML tag to the .fdseq file, and closes the file. Since a package contains only on Fixed Document Sequence, this function should not be called until the package is being finalized.</p>
<p>This function will not automatically close any currently-open Fixed Document. Call <code><a class="el" href="xpsbuild_8c.html#a46c902b78c96d0408105b77dbbcfe01d" title="End the current Fixed Document context.">endFixedDocumentBuild()</a></code> first.</p>
<p>This function will not close the bootstrap (_rels/.rels) file, or the content types file. These two files must be closed separately before the package is finalized.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pContext</em>&nbsp;</td><td>The build context.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pDevErr</em>&nbsp;</td><td>Receives a standard core device error code if there is a failure.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Zero on success; -1 on failure. </dd></dl>

</div>
</div>
<a class="anchor" id="a435ff8580afc32e6f63e19e77a3c3388"></a><!-- doxytag: member="xpsbuild.c::freeXPSPackageInMemory" ref="a435ff8580afc32e6f63e19e77a3c3388" args="(void *pContext, URIContextMappingsList *pMappings)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void freeXPSPackageInMemory </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>pContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct__URIContextMappingsList.html">URIContextMappingsList</a> *&nbsp;</td>
          <td class="paramname"> <em>pMappings</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Release all memory associated with an XPS package that was previously built with <code><a class="el" href="xpsbuild_8c.html#a1ac54b1c8e97f3a7e092558fc301a03e" title="Build an XPS package in memory, and return a pointer to the build context.">buildXPSPackageInMemory()</a></code>. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pContext</em>&nbsp;</td><td>A pointer to the build context. This <em>must</em> be a pointer that was returned from an earlier, successful call to <code><a class="el" href="xpsbuild_8c.html#a1ac54b1c8e97f3a7e092558fc301a03e" title="Build an XPS package in memory, and return a pointer to the build context.">buildXPSPackageInMemory()</a></code>.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pMappings</em>&nbsp;</td><td>Pointer to a populated list of URI context mappings. This <em>must</em> be a list that was populated by an earlier, successful call to <code><a class="el" href="xpsbuild_8c.html#a1ac54b1c8e97f3a7e092558fc301a03e" title="Build an XPS package in memory, and return a pointer to the build context.">buildXPSPackageInMemory()</a></code>. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a0ff279061f9b23046343f07a2d190d17"></a><!-- doxytag: member="xpsbuild.c::getXPSPackageRoot" ref="a0ff279061f9b23046343f07a2d190d17" args="(void *pContext)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct__MFSNODE.html">MFSNODE</a>* getXPSPackageRoot </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>pContext</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns the root node of RAM filesystem storage for the XPS package. </p>
<p>The node returned by this function will be a directory node. A file of the name "_rels/.rels" will exist relative to this root. This file can be used as input to the <code>xmlexec</code> operator, in order to interpret and render the package.</p>
<p>The node returned by this function should not be freed directly with <code><a class="el" href="memfs_8c.html#ace205408816af77dc43b4423e99e9a99" title="Destroy the given root node, and the entire virtual filesystem descended from it...">MFSReleaseRoot()</a></code>. Instead, always free the package and all of its resources using <code><a class="el" href="xpsbuild_8c.html#a435ff8580afc32e6f63e19e77a3c3388" title="Release all memory associated with an XPS package that was previously built with...">freeXPSPackageInMemory()</a></code>.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pContext</em>&nbsp;</td><td>A pointer to the build context. This <em>must</em> be a pointer that was returned from an earlier, successful call to <code><a class="el" href="xpsbuild_8c.html#a1ac54b1c8e97f3a7e092558fc301a03e" title="Build an XPS package in memory, and return a pointer to the build context.">buildXPSPackageInMemory()</a></code>. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a6bd614cbd1aa9b5c4768079285f1a0c3"></a><!-- doxytag: member="xpsbuild.c::lookupContextMapping" ref="a6bd614cbd1aa9b5c4768079285f1a0c3" args="(URIContextMappingsList *pMappings, uint8 *pszPartName)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct__URIContextMapping.html">URIContextMapping</a>* lookupContextMapping </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__URIContextMappingsList.html">URIContextMappingsList</a> *&nbsp;</td>
          <td class="paramname"> <em>pMappings</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__stdtypes.html#ga3c77e3a247345b581bdb6939ffe95a94">uint8</a> *&nbsp;</td>
          <td class="paramname"> <em>pszPartName</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Helper utility for looking up a single entry in a list of URI context mappings. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pMappings</em>&nbsp;</td><td>The list to be searched.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pszPartName</em>&nbsp;</td><td>The part name acting as the search key.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>A pointer to a matching entry within the given list, or <code>NULL</code> if there is no matching entry. When a pointer is returned, it is always a direct pointer to an entry within the given list. It is not a pointer to a copy of the entry. If a fresh copy of the entry is required, the caller is responsible for creating it. The caller should not free the returned structure directly. The mappings list as a whole will be freed automatically when the XPS package is destroyed with <code><a class="el" href="xpsbuild_8c.html#a435ff8580afc32e6f63e19e77a3c3388" title="Release all memory associated with an XPS package that was previously built with...">freeXPSPackageInMemory()</a></code>. </dd></dl>

</div>
</div>
<a class="anchor" id="afdeea660cfa7dc3e0ba03e0a0f2bbef3"></a><!-- doxytag: member="xpsbuild.c::makePartURI" ref="afdeea660cfa7dc3e0ba03e0a0f2bbef3" args="(uint8 *pszPreSpecifiedUri, uint32 partType, uint32 iDoc, uint32 iPage, uint32 fRels, char *pszURI)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void makePartURI </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__stdtypes.html#ga3c77e3a247345b581bdb6939ffe95a94">uint8</a> *&nbsp;</td>
          <td class="paramname"> <em>pszPreSpecifiedUri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__stdtypes.html#ga8ad23e2333787a214e20a58a284a5a60">uint32</a>&nbsp;</td>
          <td class="paramname"> <em>partType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__stdtypes.html#ga8ad23e2333787a214e20a58a284a5a60">uint32</a>&nbsp;</td>
          <td class="paramname"> <em>iDoc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__stdtypes.html#ga8ad23e2333787a214e20a58a284a5a60">uint32</a>&nbsp;</td>
          <td class="paramname"> <em>iPage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__stdtypes.html#ga8ad23e2333787a214e20a58a284a5a60">uint32</a>&nbsp;</td>
          <td class="paramname"> <em>fRels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>pszURI</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Build the appropriate URI for a part within the package. </p>
<p>By default, part URIs are constructed according to a fixed schema, which is based on the recommended patterns as set out in the XPS specification. For example, the FixedPage markup for Page 5 of Document 1 is always <code>"/documents/1/pages/5.fpage"</code>. The default behaviour can be overriden by supplying a pre-specified URI as the first argument.</p>
<p>The URI is written into caller-managed string memory, pointed to by <code>pszURI</code>. Canonical lower case is used for all part names, which makes for straightforward name matching in the XPS input device.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pszPreSpecifiedUri</em>&nbsp;</td><td>If the caller already knows the part name, then this argument points to its NUL-terminated string (whose memory remains the property of the caller). This parameter may be <code>NUL</code>, in which case the default URI pattern is adopted based on <code>iDoc</code> and <code>iPage</code>. When using pre-specified URIs, the output string is a canonical transformation of the input string. For example, the pre-specified part name <code>"/FixedPage_0.xaml"</code> would be canonicalized to <code>"/fixedpage_0.xaml"</code> as its part name, and to <code>"/_rels/fixedpage_0.xaml.rels"</code> as its relationships name.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>partType</em>&nbsp;</td><td>One of <code>PartType_FDSEQ</code>, <code>PartType_FDOC</code>, <code>PartType_FPAGE</code>, <code>PartType_JobPT</code>, <code>PartType_DocPT</code>, <code>PartType_PagePT</code>.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>iDoc</em>&nbsp;</td><td>Zero-based document index. This is ignored for parts that are not in a per-document scope, such as <code>PartType_FDSEQ</code> or <code>PartType_JobPT</code>. Note that URI formation is based on 1-based indices, so the implementation will automatically increment this zero-based index.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>iPage</em>&nbsp;</td><td>Zero-based page index within the scope of the document. This is ignored for parts that are not in a per-page scope, such as <code>PartType_FDOC</code> or <code>PartType_FDSEQ</code>. Note that URI formation is based on 1-based indices, so the implementation will automatically increment this zero-based index.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>fRels</em>&nbsp;</td><td>Indicates whether we want the base part name, or the relationships part name. Pass <code>TRUE</code> to get the relationships part name. For example, for <code>PartType_FDOC</code> and <code>iDoc == 0</code>, the function (by default) constructs <code>"/documents/1/fixeddocument.fdoc"</code> as the base part name, but <code>"/documents/1/_rels/fixeddocument.fdoc.rels"</code> as the relationships part name. If the part name is pre-specified, then the corresponding relationships name is constructed by inserting <code>"_rels/"</code> into the path before the leafname, and appending <code>".rels"</code> to the end of the string.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pszURI</em>&nbsp;</td><td>Receives the NUL-terminated partname. This is a pointer to caller-managed memory, which must have space for at least <code>LONGESTFILENAME</code> characters, including the NUL terminator. If <code>pszPreSpecifiedUri</code> is supplied, then the output will simply be a copy of this string (canonicalized to lower case), or a transformed version of it when <code>fRels == TRUE</code>. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="af23ddb990f65f9b0ef9498e3b8036297"></a><!-- doxytag: member="xpsbuild.c::makeRelsNameFromPartName" ref="af23ddb990f65f9b0ef9498e3b8036297" args="(char *pszPartName, char *pszRelsName)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void makeRelsNameFromPartName </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>pszPartName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>pszRelsName</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Utility function allowing <code><a class="el" href="xpsbuild_8c.html#afdeea660cfa7dc3e0ba03e0a0f2bbef3" title="Build the appropriate URI for a part within the package.">makePartURI()</a></code> to construct relationship names from pre-specified part names. </p>
<p>Inserts <code>"_rels/"</code> as an extra pathname element before the leafname, and appends <code>".rels"</code> to the leafname. For instance, the input <code>"/Documents/1/Pages/5.fpage"</code> would produce the output <code>"/Documents/1/Pages/_rels/5.fpage.rels"</code>.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pszPartName</em>&nbsp;</td><td>The NUL-terminated input string.</td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>pszRelsName</em>&nbsp;</td><td>Pointer to caller-managed string memory, which receives the output. The buffer should have enough space for <code>LONGESTFILENAME</code> characters. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a9ee19af916b267dc5205253b135a41ed"></a><!-- doxytag: member="xpsbuild.c::openContentTypes" ref="a9ee19af916b267dc5205253b135a41ed" args="(ContentTypesManager *pCTM, int32 *pDevErr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> openContentTypes </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__ContentTypesManager.html">ContentTypesManager</a> *&nbsp;</td>
          <td class="paramname"> <em>pCTM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> *&nbsp;</td>
          <td class="paramname"> <em>pDevErr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Write the XML header and opening tag for a Content Types file. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pCTM</em>&nbsp;</td><td>Structure managing the addition of Override entries, which also contains a handle to the [Content_Types].xml file itself.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pDevErr</em>&nbsp;</td><td>Receives a standard core device error code if there is a failure.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The number of bytes of data written to the file, or -1 if there has been an error. </dd></dl>

</div>
</div>
<a class="anchor" id="acae2cc11d85160e7e4a1e7895976f949"></a><!-- doxytag: member="xpsbuild.c::openFixedDocument" ref="acae2cc11d85160e7e4a1e7895976f949" args="(MFSFILEDESC *pFD, int32 *pDevErr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> openFixedDocument </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="memfs_8h.html#a149dff2dc199b173cd81b48368ca72e2">MFSFILEDESC</a> *&nbsp;</td>
          <td class="paramname"> <em>pFD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> *&nbsp;</td>
          <td class="paramname"> <em>pDevErr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Write the XML header and opening tag for a FixedDocument (.fdoc) file. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pFD</em>&nbsp;</td><td>Open handle to the .fdoc file.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pDevErr</em>&nbsp;</td><td>Receives a standard core device error code if there is a failure.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The number of bytes of data written to the file, or -1 if there has been an error. </dd></dl>

</div>
</div>
<a class="anchor" id="a330cc2b5988b968316b1e5b8e1d56ac3"></a><!-- doxytag: member="xpsbuild.c::openFixedDocumentSequence" ref="a330cc2b5988b968316b1e5b8e1d56ac3" args="(MFSFILEDESC *pFD, int32 *pDevErr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> openFixedDocumentSequence </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="memfs_8h.html#a149dff2dc199b173cd81b48368ca72e2">MFSFILEDESC</a> *&nbsp;</td>
          <td class="paramname"> <em>pFD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> *&nbsp;</td>
          <td class="paramname"> <em>pDevErr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Write the XML header and opening tag for a FixedDocumentSequence (.fdseq) file. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pFD</em>&nbsp;</td><td>Open handle to the .fdseq file.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pDevErr</em>&nbsp;</td><td>Receives a standard core device error code if there is a failure.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The number of bytes of data written to the file, or -1 if there has been an error. </dd></dl>

</div>
</div>
<a class="anchor" id="ae865bc2c78d55f9dd9c92c36664c2418"></a><!-- doxytag: member="xpsbuild.c::openXMLRelationships" ref="ae865bc2c78d55f9dd9c92c36664c2418" args="(RelsFileManager *pRFM, int32 *pDevErr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> openXMLRelationships </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__RelsFileManager.html">RelsFileManager</a> *&nbsp;</td>
          <td class="paramname"> <em>pRFM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> *&nbsp;</td>
          <td class="paramname"> <em>pDevErr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Write the standard XML header line and the correct XML opening tag for XPS relationships. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pRFM</em>&nbsp;</td><td>Management structure for the relationships file.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pDevErr</em>&nbsp;</td><td>Receives a standard core device error code if there is a failure.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The number of bytes of data written to the file, or -1 if there has been an error. </dd></dl>

</div>
</div>
<a class="anchor" id="ae3ca2185b4d07d48a78ccf5d6d41962d"></a><!-- doxytag: member="xpsbuild.c::startFixedDocumentBuild" ref="ae3ca2185b4d07d48a78ccf5d6d41962d" args="(PackageBuildContext *pPC, int32 *pDevErr, XPSDocumentDescription *pDoc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> startFixedDocumentBuild </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__PackageBuildContext.html">PackageBuildContext</a> *&nbsp;</td>
          <td class="paramname"> <em>pPC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> *&nbsp;</td>
          <td class="paramname"> <em>pDevErr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct__XPSDocumentDescription.html">XPSDocumentDescription</a> *&nbsp;</td>
          <td class="paramname"> <em>pDoc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Begin a new Fixed Document context for the package. </p>
<p>This function can be called an arbitrary number of times during construction of a package. This matches the XPS specification, which permits for any number of Fixed Documents in a single Fixed Document Sequence. (However, it is quite typical for packages to contain just one Fixed Document).</p>
<p>The parent .fdseq file is assumed to already exist. This function will add a new DocumentReference element to it, and leave the file open. If there is a current .fdoc file open, this function will close it by automatically calling <code><a class="el" href="xpsbuild_8c.html#a46c902b78c96d0408105b77dbbcfe01d" title="End the current Fixed Document context.">endFixedDocumentBuild()</a></code>.</p>
<p>A new .fdoc file will be created by this function, along with its corresponding relationships file. If the document has a print ticket, a print ticket relationship is written to the relationships file. The relationships file will then be closed, while the .fdoc file itself will remain open. Pages can then be added to the document by calling <code><a class="el" href="xpsbuild_8c.html#ae520fa1adb9a5eadbc8edd2f258c9029" title="Adds a Fixed Page in the context of the currently-open document.">addFixedPage()</a></code>.</p>
<p>A content type Override element will be added for the .fdoc file and its relationships part. The content type file itself is left open.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pPC</em>&nbsp;</td><td>The build context.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pDevErr</em>&nbsp;</td><td>Receives a standard core device error code if there is a failure.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pDoc</em>&nbsp;</td><td>Pointer to a description of the new document. Note that any page descriptions nested in the document description are <em>not</em> added automatically by this function.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Zero on success; -1 on failure. </dd></dl>

</div>
</div>
<a class="anchor" id="a1086ddde5c5faac9c0071344e7c5db18"></a><!-- doxytag: member="xpsbuild.c::startFixedDocumentSequenceBuild" ref="a1086ddde5c5faac9c0071344e7c5db18" args="(PackageBuildContext *pContext, int32 *pDevErr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> startFixedDocumentSequenceBuild </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__PackageBuildContext.html">PackageBuildContext</a> *&nbsp;</td>
          <td class="paramname"> <em>pContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> *&nbsp;</td>
          <td class="paramname"> <em>pDevErr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Begin the Fixed Document Sequence context for the package. </p>
<p>This function can only be called once during construction of a package. This matches the XPS specification, which permits for exactly one Fixed Document Sequence in any one package.</p>
<p>A new .fdseq file will be created, along with its corresponding relationships file. If the document sequence has a print ticket, a print ticket relationship is written to the relationships file. The relationships file will then be closed, while the .fdseq file will be left open. Documents can then be added to the sequence by calling <code><a class="el" href="xpsbuild_8c.html#ae3ca2185b4d07d48a78ccf5d6d41962d" title="Begin a new Fixed Document context for the package.">startFixedDocumentBuild()</a></code>, and pages can subsequently be added with <code><a class="el" href="xpsbuild_8c.html#ae520fa1adb9a5eadbc8edd2f258c9029" title="Adds a Fixed Page in the context of the currently-open document.">addFixedPage()</a></code>.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pContext</em>&nbsp;</td><td>The build context.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pDevErr</em>&nbsp;</td><td>Receives a standard core device error code if there is a failure.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Zero on success; -1 on failure. </dd></dl>

</div>
</div>
<a class="anchor" id="a8fcddfb0d1c81359a8e219a05bd5f6d6"></a><!-- doxytag: member="xpsbuild.c::writeContentTypeOverride" ref="a8fcddfb0d1c81359a8e219a05bd5f6d6" args="(ContentTypesManager *pCTM, char *pszPartName, char *pszType, int32 *pDevErr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> writeContentTypeOverride </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__ContentTypesManager.html">ContentTypesManager</a> *&nbsp;</td>
          <td class="paramname"> <em>pCTM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>pszPartName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>pszType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> *&nbsp;</td>
          <td class="paramname"> <em>pDevErr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Write an Override element into the given Content Types file. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pCTM</em>&nbsp;</td><td>Structure managing the addition of Override entries, which also contains a handle to the [Content_Types].xml file itself.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pszPartName</em>&nbsp;</td><td>Part name whose content type is being specified. If an override has already been written for this part name, the function will do nothing (and return zero).</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pszType</em>&nbsp;</td><td>The content type corresponding to the given part name, eg. <code>"application/vnd.ms-opentype"</code>.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pDevErr</em>&nbsp;</td><td>Receives a standard core device error code if there is a failure.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The number of bytes of data written to the file, or -1 if there has been an error. </dd></dl>

</div>
</div>
<a class="anchor" id="a7aabf57c5685e238f3f61c9c3c50da68"></a><!-- doxytag: member="xpsbuild.c::writeDocumentReference" ref="a7aabf57c5685e238f3f61c9c3c50da68" args="(MFSFILEDESC *pFD, char *pszUriDocument, int32 *pDevErr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> writeDocumentReference </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="memfs_8h.html#a149dff2dc199b173cd81b48368ca72e2">MFSFILEDESC</a> *&nbsp;</td>
          <td class="paramname"> <em>pFD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>pszUriDocument</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> *&nbsp;</td>
          <td class="paramname"> <em>pDevErr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Write a DocumentReference element to the given FixedDocumentSequence (.fdseq) file. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pFD</em>&nbsp;</td><td>Open handle to the .fdseq file.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pszUriDocument</em>&nbsp;</td><td>Part name of the .fdoc file being added.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pDevErr</em>&nbsp;</td><td>Receives a standard core device error code if there is a failure.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The number of bytes of data written to the file, or -1 if there has been an error. </dd></dl>

</div>
</div>
<a class="anchor" id="a49dbb45502758a03932bda1420f1be4c"></a><!-- doxytag: member="xpsbuild.c::writePageReference" ref="a49dbb45502758a03932bda1420f1be4c" args="(MFSFILEDESC *pFD, char *pszUriPage, int32 *pDevErr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> writePageReference </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="memfs_8h.html#a149dff2dc199b173cd81b48368ca72e2">MFSFILEDESC</a> *&nbsp;</td>
          <td class="paramname"> <em>pFD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>pszUriPage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> *&nbsp;</td>
          <td class="paramname"> <em>pDevErr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Write a PageContent element to the given FixedDocument (.fdoc) file. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pFD</em>&nbsp;</td><td>Open handle to the .fdoc file.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pszUriPage</em>&nbsp;</td><td>Part name of the .fpage file being added. Note that the .fpage file itself is not written to the package, but it is assumed to exist externally.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pDevErr</em>&nbsp;</td><td>Receives a standard core device error code if there is a failure.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The number of bytes of data written to the file, or -1 if there has been an error. </dd></dl>

</div>
</div>
<a class="anchor" id="a0121dc2befc938c561d44125a1399d97"></a><!-- doxytag: member="xpsbuild.c::writeXMLHeader" ref="a0121dc2befc938c561d44125a1399d97" args="(MFSFILEDESC *pFD, int32 *pDevErr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> writeXMLHeader </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="memfs_8h.html#a149dff2dc199b173cd81b48368ca72e2">MFSFILEDESC</a> *&nbsp;</td>
          <td class="paramname"> <em>pFD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> *&nbsp;</td>
          <td class="paramname"> <em>pDevErr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Write the standard XML header line to the given file. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pFD</em>&nbsp;</td><td>MFS file descriptor open for writing.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pDevErr</em>&nbsp;</td><td>Receives a standard core device error code if there is a failure.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The number of bytes of data written to the file, or -1 if there has been an error. </dd></dl>

</div>
</div>
<a class="anchor" id="a4118451767f3e3810490e5d193727016"></a><!-- doxytag: member="xpsbuild.c::writeXMLRelationship" ref="a4118451767f3e3810490e5d193727016" args="(RelsFileManager *pRFM, uint32 relType, char *pszTarget, int32 *pDevErr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> writeXMLRelationship </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct__RelsFileManager.html">RelsFileManager</a> *&nbsp;</td>
          <td class="paramname"> <em>pRFM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__stdtypes.html#ga8ad23e2333787a214e20a58a284a5a60">uint32</a>&nbsp;</td>
          <td class="paramname"> <em>relType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>pszTarget</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> *&nbsp;</td>
          <td class="paramname"> <em>pDevErr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Add a relationship entry tag to the given rels file, and increment the relationship ID. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pRFM</em>&nbsp;</td><td>Management structure for the relationships file.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>relType</em>&nbsp;</td><td>One of <code>RelType_FixedRepresentation</code>, <code>RelType_RequiredResource</code>, <code>RelType_PrintTicket</code>.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pszTarget</em>&nbsp;</td><td>The relationship's target part name.</td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pDevErr</em>&nbsp;</td><td>Receives a standard core device error code if there is a failure.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The number of bytes of data written to the file, or -1 if there has been an error. </dd></dl>

</div>
</div>
</div>
<hr size="1"><address style="align: right;">
<!-- $HopeName: SWprod_hqnrip!clrip:branding:footer.html(EBDSDK_P.1) $ -->
<!-- Copyright (C) 2007 Global Graphics Software Ltd. All rights reserved. -->
<!-- Global Graphics Software Ltd. Confidential Information. -->

<i><small>For information on other products from Global Graphics, visit <a href="http://www.globalgraphics.com" target="_blank">www.globalgraphics.com</a></small></i></address>
</body>
</html>
