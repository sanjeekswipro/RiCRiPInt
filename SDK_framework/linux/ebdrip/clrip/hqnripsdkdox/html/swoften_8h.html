<!-- Copyright (C) 2007 Global Graphics Software Ltd. All rights reserved. -->
<!-- Global Graphics Software Ltd. Confidential Information. -->
<!-- $HopeName: SWprod_hqnrip!clrip:branding:lekit-header.html(EBDSDK_P.1) $ -->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"> <html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1"> <title>Harlequin RIP SDK: swoften.h File Reference</title> <h5 style="align: right;"><a href="http://www.globalgraphics.com" target="_blank"><img src="./gg_logo.gif" alt="Global Graphics logo" align="middle" border=0></a><img src="./spacer.gif">Harlequin RIP SDK Documentation</h5> <link href="doxygen.css" rel="stylesheet" type="text/css"> </head> </html> 
<!-- Generated by Doxygen 1.6.2 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_58e073c29fb8ad03683bffd38f34fa64.html">core</a>&nbsp;&raquo;&nbsp;<a class="el" href="dir_3b063d3933c3ab795dc82229f70873d8.html">interface</a>&nbsp;&raquo;&nbsp;<a class="el" href="dir_674ebe318ef6d1d8ac91a23619c345ad.html">control</a>
  </div>
</div>
<div class="contents">
<h1>swoften.h File Reference</h1>
<p>This file contains definitions necessary to incorporate SwOften macros in OEM code.  
<a href="#_details">More...</a></p>
<code>#include &quot;<a class="el" href="ripcall_8h.html">ripcall.h</a>&quot;</code><br/>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="swoften_8h.html#afbab48b0d1b4a9fd37c3653710120a64">SwOften</a>()&nbsp;&nbsp;&nbsp;SkinOftenUnsafe()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="swoften_8h.html#a5d4f327c1ffaad744cc6f44103340110">SwTickle</a>&nbsp;&nbsp;&nbsp;(* <a class="el" href="swoften_8h.html#a5425a1149056fe71091e751ecad506b5">SwTimer</a>)</td></tr>
<tr><td colspan="2"><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a>(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="swoften_8h.html#ae7f02e444ae9a33169d123dfef767fe4">SkinTimerExpiredFn</a> )()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Defines a callback that the skin can implement to signal expiry of the <code>SwTimer</code>.  <a href="#ae7f02e444ae9a33169d123dfef767fe4"></a><br/></td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="swoften_8h.html#ae7c0b96fa2ac213bd4c7ed3ab410e6d6">SwOftenCore</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="swoften_8h.html#a3fd992f9f29acce3f6e7cb9453e43924">SetSwTimer</a> (<a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> FAR *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="swoften_8h.html#a60c0efd291135260c4240b03bb2c15d2">SetSkinTimerExpiredFn</a> (<a class="el" href="swoften_8h.html#ae7f02e444ae9a33169d123dfef767fe4">SkinTimerExpiredFn</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sets the given function as the timer expiry callback.  <a href="#a60c0efd291135260c4240b03bb2c15d2"></a><br/></td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">IMPORT_SPEC <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> FAR *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="swoften_8h.html#a5425a1149056fe71091e751ecad506b5">SwTimer</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Mask out the declaration of variables in contexts when using the Microsoft Linker DELAYLOAD feature for the core RIP DLL on the PC.  <a href="#a5425a1149056fe71091e751ecad506b5"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>This file contains definitions necessary to incorporate SwOften macros in OEM code. </p>
<dl class="rcs"><dt><b>HopeName</b></dt><dd>COREinterface_control!swoften.h(EBDSDK_P.1) </dd></dl>
<p>Copyright (C) 1992-2011 Global Graphics Software Ltd. All rights reserved. Global Graphics Software Ltd. Confidential Information.</p>
<p>SwOften must be called frequently in routines which are likely to take some time to complete: for example, if a large write is being done, it should be broken down into smaller chunks, with a call to SwOften each time round the loop.</p>
<p>There are two versions of which only one will be compiled: for systems with and without a real time clock interrupt of some sort.</p>
<p>Note that SwOften may be called recursively, and therefore the device tickle_functions which it activates may also be called recursively. Tickle functions are responsible for resetting their own timer. A function that does not do so will be called on every clock tick thereafter.</p>
<p>Note also that if SwOften returns a negative number, the caller must tidy up and return immediately since an interrupt has been requested.</p>
<p>PC users note: when using appropriate tools, particularly in respect of DOS extenders, it will be necessary for SwTimer to be a FAR pointer, since the decrement will need to be done in an interrupt for which access via a FAR pointer is required.</p>
<p>NOTE: this file is now set up by default to use prototyped functions. If you require not to use prototypes you should arrange for the macro SW_NO_PROTOTYPES to be defined when compiling. </p>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="afbab48b0d1b4a9fd37c3653710120a64"></a><!-- doxytag: member="swoften.h::SwOften" ref="afbab48b0d1b4a9fd37c3653710120a64" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SwOften</td>
          <td>(</td>
&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;SkinOftenUnsafe()</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>SwOften is calling the unsafe version, as we are not supposed to process async requests such as async interrupt when a ptask is running. See task 30320. </p>

</div>
</div>
<a class="anchor" id="a5d4f327c1ffaad744cc6f44103340110"></a><!-- doxytag: member="swoften.h::SwTickle" ref="a5d4f327c1ffaad744cc6f44103340110" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SwTickle&nbsp;&nbsp;&nbsp;(* <a class="el" href="swoften_8h.html#a5425a1149056fe71091e751ecad506b5">SwTimer</a>)</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>SwTimer is a pointer to an integer; earlier versions had SwTickle, an integer referred to directly. For upward compatibility therefore, SwTickle is a macro which redefines SwTickle in terms of SwTimer. </p>

</div>
</div>
<hr/><h2>Typedef Documentation</h2>
<a class="anchor" id="ae7f02e444ae9a33169d123dfef767fe4"></a><!-- doxytag: member="swoften.h::SkinTimerExpiredFn" ref="ae7f02e444ae9a33169d123dfef767fe4" args=")()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a>( * <a class="el" href="swoften_8h.html#ae7f02e444ae9a33169d123dfef767fe4">SkinTimerExpiredFn</a>)()</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Defines a callback that the skin can implement to signal expiry of the <code>SwTimer</code>. </p>
<p>To import a variable from the corerip dll product into its skin, the PC requires that this variable is marked with a declspec. Imported functions don't require this because the information is given on the command line of the linker. Variable imports cause the compiler to generate different code, and hence this blech is needed here. This callback can be used if the host platform does not provide any means for the skin to decrement <code>SwTimer</code> independently. See <code><a class="el" href="swoften_8h.html#a3fd992f9f29acce3f6e7cb9453e43924">SetSwTimer()</a></code> for more information.</p>
<dl class="return"><dt><b>Returns:</b></dt><dd><code>TRUE</code> if the timer has expired, otherwise <code>FALSE</code>. </dd></dl>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a60c0efd291135260c4240b03bb2c15d2"></a><!-- doxytag: member="swoften.h::SetSkinTimerExpiredFn" ref="a60c0efd291135260c4240b03bb2c15d2" args="(SkinTimerExpiredFn)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SetSkinTimerExpiredFn </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="swoften_8h.html#ae7f02e444ae9a33169d123dfef767fe4">SkinTimerExpiredFn</a>&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Sets the given function as the timer expiry callback. </p>
<p>The RIP skin should always call <code><a class="el" href="swoften_8h.html#a3fd992f9f29acce3f6e7cb9453e43924">SetSwTimer()</a></code> (or assign to the <code>SwTimer</code> variable), but calling <code><a class="el" href="swoften_8h.html#a60c0efd291135260c4240b03bb2c15d2" title="Sets the given function as the timer expiry callback.">SetSkinTimerExpiredFn()</a></code> is optional.</p>
<p>The skin can implement a timer expiry callback in situations where it cannot decrement the <code>SwTimer</code> variable directly. For example, on platforms that do not support multi-threading, it is not possible to spawn a separate thread to decrement the timer. A hardware interrupt mechanism may exist as an alternative, but, if it does not, the RIP will poll this callback at regular intervals. The callback takes no arguments. It should return <code>TRUE</code> when the timer has expired. The skin can, for example, check a system clock from within its implementation of the callback.</p>
<p>If the skin is able to use a threaded or interrupt-driven mechanism to manage the timer, it should not call this function. Registering an expiry callback in this situation is harmless, but unnecessary, and may incur a performance penalty. </p>

</div>
</div>
<a class="anchor" id="a3fd992f9f29acce3f6e7cb9453e43924"></a><!-- doxytag: member="swoften.h::SetSwTimer" ref="a3fd992f9f29acce3f6e7cb9453e43924" args="(int32 FAR *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SetSwTimer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> FAR *&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Assigns the given integer pointer to SwTimer. Normally, you would just assign the pointer directly to SwTimer. This function is mainly intended to assist when using the Microsoft Linker DELAYLOAD option on the PC, since SwTimer itself is made unavailable in this case. </p>

</div>
</div>
<a class="anchor" id="ae7c0b96fa2ac213bd4c7ed3ab410e6d6"></a><!-- doxytag: member="swoften.h::SwOftenCore" ref="ae7c0b96fa2ac213bd4c7ed3ab410e6d6" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> SwOftenCore </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Identical to <a class="el" href="swoften_8h.html#afbab48b0d1b4a9fd37c3653710120a64">SwOften()</a>, but a pure function rather than a macro, exported from the core library. </p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="a5425a1149056fe71091e751ecad506b5"></a><!-- doxytag: member="swoften.h::SwTimer" ref="a5425a1149056fe71091e751ecad506b5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">IMPORT_SPEC <a class="el" href="group__stdtypes.html#gada104807b93ac7cd59dac80d98ba857b">int32</a> FAR* <a class="el" href="swoften_8h.html#a5425a1149056fe71091e751ecad506b5">SwTimer</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Mask out the declaration of variables in contexts when using the Microsoft Linker DELAYLOAD feature for the core RIP DLL on the PC. </p>
<p>This is because imports of variables are not supported by this feature, and we want to avoid any possibility of an unintended reference to a symbol that is not fixed up. When using DELAYLOAD, <a class="el" href="swoften_8h.html#afbab48b0d1b4a9fd37c3653710120a64">SwOften()</a> is also redefined as a function exported from the core library, again avoiding the variable references resulting from macro-expansion. Use <code><a class="el" href="swoften_8h.html#a3fd992f9f29acce3f6e7cb9453e43924">SetSwTimer()</a></code> to initialize the timer, and/or <code><a class="el" href="swoften_8h.html#a60c0efd291135260c4240b03bb2c15d2" title="Sets the given function as the timer expiry callback.">SetSkinTimerExpiredFn()</a></code> to initialize the expiry function. </p>

</div>
</div>
</div>
<hr size="1"><address style="align: right;">
<!-- $HopeName: SWprod_hqnrip!clrip:branding:footer.html(EBDSDK_P.1) $ -->
<!-- Copyright (C) 2007 Global Graphics Software Ltd. All rights reserved. -->
<!-- Global Graphics Software Ltd. Confidential Information. -->

<i><small>For information on other products from Global Graphics, visit <a href="http://www.globalgraphics.com" target="_blank">www.globalgraphics.com</a></small></i></address>
</body>
</html>
